(self["webpackChunk"] = self["webpackChunk"] || []).push([["vendors-node_modules_core-js_modules_es_array_find_js-node_modules_ublaboo-datagrid_assets_da-ddb979"],{

/***/ "./node_modules/core-js/internals/add-to-unscopables.js":
/*!**************************************************************!*\
  !*** ./node_modules/core-js/internals/add-to-unscopables.js ***!
  \**************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "./node_modules/core-js/internals/well-known-symbol.js");
var create = __webpack_require__(/*! ../internals/object-create */ "./node_modules/core-js/internals/object-create.js");
var definePropertyModule = __webpack_require__(/*! ../internals/object-define-property */ "./node_modules/core-js/internals/object-define-property.js");

var UNSCOPABLES = wellKnownSymbol('unscopables');
var ArrayPrototype = Array.prototype;

// Array.prototype[@@unscopables]
// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
if (ArrayPrototype[UNSCOPABLES] == undefined) {
  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {
    configurable: true,
    value: create(null)
  });
}

// add a key to Array.prototype[@@unscopables]
module.exports = function (key) {
  ArrayPrototype[UNSCOPABLES][key] = true;
};


/***/ }),

/***/ "./node_modules/core-js/internals/array-iteration.js":
/*!***********************************************************!*\
  !*** ./node_modules/core-js/internals/array-iteration.js ***!
  \***********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var bind = __webpack_require__(/*! ../internals/function-bind-context */ "./node_modules/core-js/internals/function-bind-context.js");
var IndexedObject = __webpack_require__(/*! ../internals/indexed-object */ "./node_modules/core-js/internals/indexed-object.js");
var toObject = __webpack_require__(/*! ../internals/to-object */ "./node_modules/core-js/internals/to-object.js");
var toLength = __webpack_require__(/*! ../internals/to-length */ "./node_modules/core-js/internals/to-length.js");
var arraySpeciesCreate = __webpack_require__(/*! ../internals/array-species-create */ "./node_modules/core-js/internals/array-species-create.js");

var push = [].push;

// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex, filterReject }` methods implementation
var createMethod = function (TYPE) {
  var IS_MAP = TYPE == 1;
  var IS_FILTER = TYPE == 2;
  var IS_SOME = TYPE == 3;
  var IS_EVERY = TYPE == 4;
  var IS_FIND_INDEX = TYPE == 6;
  var IS_FILTER_REJECT = TYPE == 7;
  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;
  return function ($this, callbackfn, that, specificCreate) {
    var O = toObject($this);
    var self = IndexedObject(O);
    var boundFunction = bind(callbackfn, that, 3);
    var length = toLength(self.length);
    var index = 0;
    var create = specificCreate || arraySpeciesCreate;
    var target = IS_MAP ? create($this, length) : IS_FILTER || IS_FILTER_REJECT ? create($this, 0) : undefined;
    var value, result;
    for (;length > index; index++) if (NO_HOLES || index in self) {
      value = self[index];
      result = boundFunction(value, index, O);
      if (TYPE) {
        if (IS_MAP) target[index] = result; // map
        else if (result) switch (TYPE) {
          case 3: return true;              // some
          case 5: return value;             // find
          case 6: return index;             // findIndex
          case 2: push.call(target, value); // filter
        } else switch (TYPE) {
          case 4: return false;             // every
          case 7: push.call(target, value); // filterReject
        }
      }
    }
    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;
  };
};

module.exports = {
  // `Array.prototype.forEach` method
  // https://tc39.es/ecma262/#sec-array.prototype.foreach
  forEach: createMethod(0),
  // `Array.prototype.map` method
  // https://tc39.es/ecma262/#sec-array.prototype.map
  map: createMethod(1),
  // `Array.prototype.filter` method
  // https://tc39.es/ecma262/#sec-array.prototype.filter
  filter: createMethod(2),
  // `Array.prototype.some` method
  // https://tc39.es/ecma262/#sec-array.prototype.some
  some: createMethod(3),
  // `Array.prototype.every` method
  // https://tc39.es/ecma262/#sec-array.prototype.every
  every: createMethod(4),
  // `Array.prototype.find` method
  // https://tc39.es/ecma262/#sec-array.prototype.find
  find: createMethod(5),
  // `Array.prototype.findIndex` method
  // https://tc39.es/ecma262/#sec-array.prototype.findIndex
  findIndex: createMethod(6),
  // `Array.prototype.filterReject` method
  // https://github.com/tc39/proposal-array-filtering
  filterReject: createMethod(7)
};


/***/ }),

/***/ "./node_modules/core-js/internals/array-species-constructor.js":
/*!*********************************************************************!*\
  !*** ./node_modules/core-js/internals/array-species-constructor.js ***!
  \*********************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var isArray = __webpack_require__(/*! ../internals/is-array */ "./node_modules/core-js/internals/is-array.js");
var isConstructor = __webpack_require__(/*! ../internals/is-constructor */ "./node_modules/core-js/internals/is-constructor.js");
var isObject = __webpack_require__(/*! ../internals/is-object */ "./node_modules/core-js/internals/is-object.js");
var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "./node_modules/core-js/internals/well-known-symbol.js");

var SPECIES = wellKnownSymbol('species');

// a part of `ArraySpeciesCreate` abstract operation
// https://tc39.es/ecma262/#sec-arrayspeciescreate
module.exports = function (originalArray) {
  var C;
  if (isArray(originalArray)) {
    C = originalArray.constructor;
    // cross-realm fallback
    if (isConstructor(C) && (C === Array || isArray(C.prototype))) C = undefined;
    else if (isObject(C)) {
      C = C[SPECIES];
      if (C === null) C = undefined;
    }
  } return C === undefined ? Array : C;
};


/***/ }),

/***/ "./node_modules/core-js/internals/array-species-create.js":
/*!****************************************************************!*\
  !*** ./node_modules/core-js/internals/array-species-create.js ***!
  \****************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var arraySpeciesConstructor = __webpack_require__(/*! ../internals/array-species-constructor */ "./node_modules/core-js/internals/array-species-constructor.js");

// `ArraySpeciesCreate` abstract operation
// https://tc39.es/ecma262/#sec-arrayspeciescreate
module.exports = function (originalArray, length) {
  return new (arraySpeciesConstructor(originalArray))(length === 0 ? 0 : length);
};


/***/ }),

/***/ "./node_modules/core-js/internals/classof.js":
/*!***************************************************!*\
  !*** ./node_modules/core-js/internals/classof.js ***!
  \***************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var TO_STRING_TAG_SUPPORT = __webpack_require__(/*! ../internals/to-string-tag-support */ "./node_modules/core-js/internals/to-string-tag-support.js");
var isCallable = __webpack_require__(/*! ../internals/is-callable */ "./node_modules/core-js/internals/is-callable.js");
var classofRaw = __webpack_require__(/*! ../internals/classof-raw */ "./node_modules/core-js/internals/classof-raw.js");
var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "./node_modules/core-js/internals/well-known-symbol.js");

var TO_STRING_TAG = wellKnownSymbol('toStringTag');
// ES3 wrong here
var CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';

// fallback for IE11 Script Access Denied error
var tryGet = function (it, key) {
  try {
    return it[key];
  } catch (error) { /* empty */ }
};

// getting tag from ES6+ `Object.prototype.toString`
module.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {
  var O, tag, result;
  return it === undefined ? 'Undefined' : it === null ? 'Null'
    // @@toStringTag case
    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag
    // builtinTag case
    : CORRECT_ARGUMENTS ? classofRaw(O)
    // ES3 arguments fallback
    : (result = classofRaw(O)) == 'Object' && isCallable(O.callee) ? 'Arguments' : result;
};


/***/ }),

/***/ "./node_modules/core-js/internals/function-bind-context.js":
/*!*****************************************************************!*\
  !*** ./node_modules/core-js/internals/function-bind-context.js ***!
  \*****************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var aCallable = __webpack_require__(/*! ../internals/a-callable */ "./node_modules/core-js/internals/a-callable.js");

// optional / simple context binding
module.exports = function (fn, that, length) {
  aCallable(fn);
  if (that === undefined) return fn;
  switch (length) {
    case 0: return function () {
      return fn.call(that);
    };
    case 1: return function (a) {
      return fn.call(that, a);
    };
    case 2: return function (a, b) {
      return fn.call(that, a, b);
    };
    case 3: return function (a, b, c) {
      return fn.call(that, a, b, c);
    };
  }
  return function (/* ...args */) {
    return fn.apply(that, arguments);
  };
};


/***/ }),

/***/ "./node_modules/core-js/internals/html.js":
/*!************************************************!*\
  !*** ./node_modules/core-js/internals/html.js ***!
  \************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var getBuiltIn = __webpack_require__(/*! ../internals/get-built-in */ "./node_modules/core-js/internals/get-built-in.js");

module.exports = getBuiltIn('document', 'documentElement');


/***/ }),

/***/ "./node_modules/core-js/internals/is-array.js":
/*!****************************************************!*\
  !*** ./node_modules/core-js/internals/is-array.js ***!
  \****************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var classof = __webpack_require__(/*! ../internals/classof-raw */ "./node_modules/core-js/internals/classof-raw.js");

// `IsArray` abstract operation
// https://tc39.es/ecma262/#sec-isarray
// eslint-disable-next-line es/no-array-isarray -- safe
module.exports = Array.isArray || function isArray(argument) {
  return classof(argument) == 'Array';
};


/***/ }),

/***/ "./node_modules/core-js/internals/is-constructor.js":
/*!**********************************************************!*\
  !*** ./node_modules/core-js/internals/is-constructor.js ***!
  \**********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var fails = __webpack_require__(/*! ../internals/fails */ "./node_modules/core-js/internals/fails.js");
var isCallable = __webpack_require__(/*! ../internals/is-callable */ "./node_modules/core-js/internals/is-callable.js");
var classof = __webpack_require__(/*! ../internals/classof */ "./node_modules/core-js/internals/classof.js");
var getBuiltIn = __webpack_require__(/*! ../internals/get-built-in */ "./node_modules/core-js/internals/get-built-in.js");
var inspectSource = __webpack_require__(/*! ../internals/inspect-source */ "./node_modules/core-js/internals/inspect-source.js");

var empty = [];
var construct = getBuiltIn('Reflect', 'construct');
var constructorRegExp = /^\s*(?:class|function)\b/;
var exec = constructorRegExp.exec;
var INCORRECT_TO_STRING = !constructorRegExp.exec(function () { /* empty */ });

var isConstructorModern = function (argument) {
  if (!isCallable(argument)) return false;
  try {
    construct(Object, empty, argument);
    return true;
  } catch (error) {
    return false;
  }
};

var isConstructorLegacy = function (argument) {
  if (!isCallable(argument)) return false;
  switch (classof(argument)) {
    case 'AsyncFunction':
    case 'GeneratorFunction':
    case 'AsyncGeneratorFunction': return false;
    // we can't check .prototype since constructors produced by .bind haven't it
  } return INCORRECT_TO_STRING || !!exec.call(constructorRegExp, inspectSource(argument));
};

// `IsConstructor` abstract operation
// https://tc39.es/ecma262/#sec-isconstructor
module.exports = !construct || fails(function () {
  var called;
  return isConstructorModern(isConstructorModern.call)
    || !isConstructorModern(Object)
    || !isConstructorModern(function () { called = true; })
    || called;
}) ? isConstructorLegacy : isConstructorModern;


/***/ }),

/***/ "./node_modules/core-js/internals/object-create.js":
/*!*********************************************************!*\
  !*** ./node_modules/core-js/internals/object-create.js ***!
  \*********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

/* global ActiveXObject -- old IE, WSH */
var anObject = __webpack_require__(/*! ../internals/an-object */ "./node_modules/core-js/internals/an-object.js");
var defineProperties = __webpack_require__(/*! ../internals/object-define-properties */ "./node_modules/core-js/internals/object-define-properties.js");
var enumBugKeys = __webpack_require__(/*! ../internals/enum-bug-keys */ "./node_modules/core-js/internals/enum-bug-keys.js");
var hiddenKeys = __webpack_require__(/*! ../internals/hidden-keys */ "./node_modules/core-js/internals/hidden-keys.js");
var html = __webpack_require__(/*! ../internals/html */ "./node_modules/core-js/internals/html.js");
var documentCreateElement = __webpack_require__(/*! ../internals/document-create-element */ "./node_modules/core-js/internals/document-create-element.js");
var sharedKey = __webpack_require__(/*! ../internals/shared-key */ "./node_modules/core-js/internals/shared-key.js");

var GT = '>';
var LT = '<';
var PROTOTYPE = 'prototype';
var SCRIPT = 'script';
var IE_PROTO = sharedKey('IE_PROTO');

var EmptyConstructor = function () { /* empty */ };

var scriptTag = function (content) {
  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;
};

// Create object with fake `null` prototype: use ActiveX Object with cleared prototype
var NullProtoObjectViaActiveX = function (activeXDocument) {
  activeXDocument.write(scriptTag(''));
  activeXDocument.close();
  var temp = activeXDocument.parentWindow.Object;
  activeXDocument = null; // avoid memory leak
  return temp;
};

// Create object with fake `null` prototype: use iframe Object with cleared prototype
var NullProtoObjectViaIFrame = function () {
  // Thrash, waste and sodomy: IE GC bug
  var iframe = documentCreateElement('iframe');
  var JS = 'java' + SCRIPT + ':';
  var iframeDocument;
  iframe.style.display = 'none';
  html.appendChild(iframe);
  // https://github.com/zloirock/core-js/issues/475
  iframe.src = String(JS);
  iframeDocument = iframe.contentWindow.document;
  iframeDocument.open();
  iframeDocument.write(scriptTag('document.F=Object'));
  iframeDocument.close();
  return iframeDocument.F;
};

// Check for document.domain and active x support
// No need to use active x approach when document.domain is not set
// see https://github.com/es-shims/es5-shim/issues/150
// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346
// avoid IE GC bug
var activeXDocument;
var NullProtoObject = function () {
  try {
    activeXDocument = new ActiveXObject('htmlfile');
  } catch (error) { /* ignore */ }
  NullProtoObject = typeof document != 'undefined'
    ? document.domain && activeXDocument
      ? NullProtoObjectViaActiveX(activeXDocument) // old IE
      : NullProtoObjectViaIFrame()
    : NullProtoObjectViaActiveX(activeXDocument); // WSH
  var length = enumBugKeys.length;
  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];
  return NullProtoObject();
};

hiddenKeys[IE_PROTO] = true;

// `Object.create` method
// https://tc39.es/ecma262/#sec-object.create
module.exports = Object.create || function create(O, Properties) {
  var result;
  if (O !== null) {
    EmptyConstructor[PROTOTYPE] = anObject(O);
    result = new EmptyConstructor();
    EmptyConstructor[PROTOTYPE] = null;
    // add "__proto__" for Object.getPrototypeOf polyfill
    result[IE_PROTO] = O;
  } else result = NullProtoObject();
  return Properties === undefined ? result : defineProperties(result, Properties);
};


/***/ }),

/***/ "./node_modules/core-js/internals/object-define-properties.js":
/*!********************************************************************!*\
  !*** ./node_modules/core-js/internals/object-define-properties.js ***!
  \********************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var DESCRIPTORS = __webpack_require__(/*! ../internals/descriptors */ "./node_modules/core-js/internals/descriptors.js");
var definePropertyModule = __webpack_require__(/*! ../internals/object-define-property */ "./node_modules/core-js/internals/object-define-property.js");
var anObject = __webpack_require__(/*! ../internals/an-object */ "./node_modules/core-js/internals/an-object.js");
var objectKeys = __webpack_require__(/*! ../internals/object-keys */ "./node_modules/core-js/internals/object-keys.js");

// `Object.defineProperties` method
// https://tc39.es/ecma262/#sec-object.defineproperties
// eslint-disable-next-line es/no-object-defineproperties -- safe
module.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {
  anObject(O);
  var keys = objectKeys(Properties);
  var length = keys.length;
  var index = 0;
  var key;
  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);
  return O;
};


/***/ }),

/***/ "./node_modules/core-js/internals/object-keys.js":
/*!*******************************************************!*\
  !*** ./node_modules/core-js/internals/object-keys.js ***!
  \*******************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var internalObjectKeys = __webpack_require__(/*! ../internals/object-keys-internal */ "./node_modules/core-js/internals/object-keys-internal.js");
var enumBugKeys = __webpack_require__(/*! ../internals/enum-bug-keys */ "./node_modules/core-js/internals/enum-bug-keys.js");

// `Object.keys` method
// https://tc39.es/ecma262/#sec-object.keys
// eslint-disable-next-line es/no-object-keys -- safe
module.exports = Object.keys || function keys(O) {
  return internalObjectKeys(O, enumBugKeys);
};


/***/ }),

/***/ "./node_modules/core-js/internals/to-string-tag-support.js":
/*!*****************************************************************!*\
  !*** ./node_modules/core-js/internals/to-string-tag-support.js ***!
  \*****************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

var wellKnownSymbol = __webpack_require__(/*! ../internals/well-known-symbol */ "./node_modules/core-js/internals/well-known-symbol.js");

var TO_STRING_TAG = wellKnownSymbol('toStringTag');
var test = {};

test[TO_STRING_TAG] = 'z';

module.exports = String(test) === '[object z]';


/***/ }),

/***/ "./node_modules/core-js/modules/es.array.find.js":
/*!*******************************************************!*\
  !*** ./node_modules/core-js/modules/es.array.find.js ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

"use strict";

var $ = __webpack_require__(/*! ../internals/export */ "./node_modules/core-js/internals/export.js");
var $find = __webpack_require__(/*! ../internals/array-iteration */ "./node_modules/core-js/internals/array-iteration.js").find;
var addToUnscopables = __webpack_require__(/*! ../internals/add-to-unscopables */ "./node_modules/core-js/internals/add-to-unscopables.js");

var FIND = 'find';
var SKIPS_HOLES = true;

// Shouldn't skip holes
if (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });

// `Array.prototype.find` method
// https://tc39.es/ecma262/#sec-array.prototype.find
$({ target: 'Array', proto: true, forced: SKIPS_HOLES }, {
  find: function find(callbackfn /* , that = undefined */) {
    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);
  }
});

// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables
addToUnscopables(FIND);


/***/ }),

/***/ "./node_modules/ublaboo-datagrid/assets/datagrid-instant-url-refresh.js":
/*!******************************************************************************!*\
  !*** ./node_modules/ublaboo-datagrid/assets/datagrid-instant-url-refresh.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

/* provided dependency */ var naja = __webpack_require__(/*! naja */ "./node_modules/naja/dist/Naja.esm.js")["default"];
/* provided dependency */ var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
var dataGridRegisterAjaxCall;

if (typeof naja !== "undefined") {
	dataGridRegisterAjaxCall = function (params) {
		var method = params.type || 'GET';
		var data = params.data || null;

		naja.makeRequest(method, params.url, data, {
			history: 'replace'
		})
			.then(params.success)
			.catch(params.error);
	};

} else {
		dataGridRegisterAjaxCall = function (params) {
			$.nette.ajax(params);
		};
}

document.addEventListener('DOMContentLoaded', function () {
	var element = document.querySelector('.datagrid');

	if (element !== null) {
		return dataGridRegisterAjaxCall({
			type: 'GET',
			url: element.getAttribute('data-refresh-state')
		});
	}
});


/***/ }),

/***/ "./node_modules/ublaboo-datagrid/assets/datagrid-spinners.js":
/*!*******************************************************************!*\
  !*** ./node_modules/ublaboo-datagrid/assets/datagrid-spinners.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

/* provided dependency */ var naja = __webpack_require__(/*! naja */ "./node_modules/naja/dist/Naja.esm.js")["default"];
/* provided dependency */ var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
var dataGridRegisterExtension;

if (typeof naja !== "undefined") {
	var isNaja2 = function () { return naja && naja.VERSION && naja.VERSION >= 2 };
	var najaEventParams = function (params) { return isNaja2() ? params.detail : params };
	var najaRequest = function (params) { return isNaja2() ? params.detail.request : params.xhr };
	dataGridRegisterExtension = function (name, extension) {
		var init = extension.init;
		var success = extension.success;
		var before = extension.before;
		var complete = extension.complete;


		var NewExtension = function NewExtension(naja, name) {
			this.name = name;

			this.initialize = function (naja) {
				if(init) {
					naja.addEventListener('init', function (params)  {
						init(najaEventParams(params).defaultOptions);
					});
				}

				if(success) {
					naja.addEventListener('success', function (params)  {
						var payload = isNaja2() ? params.detail.payload : params.response;
						success(payload, najaEventParams(params).options);
					});
				}

				if(before) {
					naja.addEventListener('before', function (params) {
						before(najaRequest(params), najaEventParams(params).options);
					});
				}

				if(complete) {
					naja.addEventListener('complete', function (params) {
						complete(najaRequest(params), najaEventParams(params).options);
					});
				}
			}
			if (!isNaja2()) {
				this.initialize(naja);
			}
			return this;
		}

		if (isNaja2()) {
			naja.registerExtension(new NewExtension(null, name));
		} else {
			naja.registerExtension(NewExtension, name);
		}
	};
} else if ($.nette) {
		dataGridRegisterExtension = function (name, extension) {
			$.nette.ext(name, extension);
		};
}

dataGridRegisterExtension('ublaboo-spinners', {
	before: function(xhr, settings) {
		var el, id, row_detail, spinner_template, grid_fullname;
		if (settings.nette) {
			el = settings.nette.el;
			spinner_template = $('<div class="ublaboo-spinner ublaboo-spinner-small"><i></i><i></i><i></i><i></i></div>');
			if (el.is('.datagrid [name="group_action[submit]"]')) {
				return el.after(spinner_template);
			} else if (el.is('.datagrid a') && el.data('toggle-detail')) {
				id = settings.nette.el.attr('data-toggle-detail');
				grid_fullname = settings.nette.el.attr('data-toggle-detail-grid-fullname');
				row_detail = $('.item-detail-' + grid_fullname + '-id-' + id);
				if (!row_detail.hasClass('loaded')) {
					return el.addClass('ublaboo-spinner-icon');
				}
			} else if (el.is('.datagrid .col-pagination a')) {
				return el.closest('.row-grid-bottom').find('.col-per-page').prepend(spinner_template);
			} else if (el.is('.datagrid .datagrid-per-page-submit')) {
				return el.closest('.row-grid-bottom').find('.col-per-page').prepend(spinner_template);
			} else if (el.is('.datagrid .reset-filter')) {
				return el.closest('.row-grid-bottom').find('.col-per-page').prepend(spinner_template);
			}
		}
	},
	complete: function() {
		$('.ublaboo-spinner').remove();
		return $('.ublaboo-spinner-icon').removeClass('ublaboo-spinner-icon');
	}
});


/***/ }),

/***/ "./node_modules/ublaboo-datagrid/assets/datagrid.js":
/*!**********************************************************!*\
  !*** ./node_modules/ublaboo-datagrid/assets/datagrid.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

/* provided dependency */ var naja = __webpack_require__(/*! naja */ "./node_modules/naja/dist/Naja.esm.js")["default"];
/* provided dependency */ var $ = __webpack_require__(/*! jquery */ "./node_modules/jquery/dist/jquery.js");
var dataGridRegisterExtension, dataGridRegisterAjaxCall, dataGridLoad, dataGridSubmitForm;

if (typeof naja !== "undefined") {
	var isNaja2 = function () { return naja && naja.VERSION && naja.VERSION >= 2 };
	var najaEventParams = function (params) { return isNaja2() ? params.detail : params };
	var najaRequest = function (params) { return isNaja2() ? params.detail.request : params.xhr };
	dataGridRegisterExtension = function (name, extension) {
		var init = extension.init;
		var success = extension.success;
		var before = extension.before;
		var complete = extension.complete;
		var interaction = extension.interaction;


		var NewExtension = function NewExtension(naja, name) {
			this.name = name;

			this.initialize = function (naja) {
				if(init) {
					naja.addEventListener('init', function (params)  {
						init(najaEventParams(params).defaultOptions);
					});
				}

				if(success) {
					naja.addEventListener('success', function (params)  {
						var payload = isNaja2() ? params.detail.payload : params.response;
						success(payload, najaEventParams(params).options);
					});
				}

				var interactionTarget = naja;
				if (isNaja2()) {
					interactionTarget = interactionTarget.uiHandler;
				}

				interactionTarget.addEventListener('interaction', function (params) {
					if (isNaja2()) {
						params.detail.options.nette = {
							el: $(params.detail.element)
						}
					} else {
						params.options.nette = {
							el: $(params.element)
						}
					}
					if (interaction) {
						if (!interaction(najaEventParams(params).options)){
							params.preventDefault();
						}
					}
				});

				if(before) {
					naja.addEventListener('before', function (params) {
						if (!before(najaRequest(params), najaEventParams(params).options))
							params.preventDefault();
					});
				}

				if(complete) {
					naja.addEventListener('complete', function (params) {
						complete(najaRequest(params), najaEventParams(params).options);
					});
				}
			}
			if (!isNaja2()) {
				this.initialize(naja);
			}
			return this;
		}

		if (isNaja2()) {
			naja.registerExtension(new NewExtension(null, name));
		} else {
			naja.registerExtension(NewExtension, name);
		}
	};


	dataGridRegisterAjaxCall = function (params) {
        var method = params.type || 'GET';
        var data = params.data || null;

		naja.makeRequest(method, params.url, data, {})
			.then(params.success)
			.catch(params.error);
	};

	dataGridLoad = function () {
		naja.load();
	};

	dataGridSubmitForm = function (form) {
		return naja.uiHandler.submitForm(form.get(0));
	};
} else if ($.nette) {
	dataGridRegisterExtension = function (name, extension) {
		$.nette.ext(name, extension);
	};
	dataGridRegisterAjaxCall = function (params) {
		$.nette.ajax(params);
	};
	dataGridLoad = function () {
		$.nette.load();
	};
	dataGridSubmitForm = function (form) {
		return form.submit();
	};
} else {
	throw new Error("Include Naja.js or nette.ajax for datagrids to work!")
}


var datagridFitlerMultiSelect, datagridGroupActionMultiSelect, datagridShiftGroupSelection, datagridSortable, datagridSortableTree, getEventDomPath,
	indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

$(document).on('click', '[data-datagrid-confirm]:not(.ajax)', function(e) {
	if (!confirm($(e.target).closest('a').attr('data-datagrid-confirm'))) {
		e.stopPropagation();
		return e.preventDefault();
	}
});

if (typeof naja !== "undefined") {
	dataGridRegisterExtension('datagrid.confirm', {
		interaction: function(settings) {
			var confirm_message;
			if (settings.nette) {
				confirm_message = settings.nette.el.data('datagrid-confirm');
				if (confirm_message) {
					return confirm(confirm_message);
				}
			}
			return true;
		}
	});
} else {
	dataGridRegisterExtension('datagrid.confirm', {
		before: function(xhr, settings) {
			var confirm_message;
			if (settings.nette) {
				confirm_message = settings.nette.el.data('datagrid-confirm');
				if (confirm_message) {
					return confirm(confirm_message);
				}
			}
			return true;
		}
	});
}


$(document).on('change', 'select[data-autosubmit-per-page]', function() {
	var button;
	button = $(this).parent().find('input[type=submit]');
	if (button.length === 0) {
		button = $(this).parent().find('button[type=submit]');
	}
	return button.click();
}).on('change', 'select[data-autosubmit]', function() {
	return dataGridSubmitForm($(this).closest('form').first());
}).on('change', 'input[data-autosubmit][data-autosubmit-change]', function(e) {
	var $this, code;
	code = e.which || e.keyCode || 0;
	clearTimeout(window.datagrid_autosubmit_timer);
	$this = $(this);
	return window.datagrid_autosubmit_timer = setTimeout((function(_this) {
		return function() {
			return dataGridSubmitForm($this.closest('form').first());
		};
	})(this), 200);
}).on('keyup', 'input[data-autosubmit]', function(e) {
	var $this, code;
	code = e.which || e.keyCode || 0;
	if ((code !== 13) && ((code >= 9 && code <= 40) || (code >= 112 && code <= 123))) {
		return;
	}
	clearTimeout(window.datagrid_autosubmit_timer);
	$this = $(this);
	return window.datagrid_autosubmit_timer = setTimeout((function(_this) {
		return function() {
			return dataGridSubmitForm($this.closest('form').first());
		};
	})(this), 200);
}).on('keydown', '.datagrid-inline-edit input', function(e) {
	var code;
	code = e.which || e.keyCode || 0;
	if (code === 13) {
		e.stopPropagation();
		e.preventDefault();
		return $(this).closest('tr').find('.col-action-inline-edit [name="inline_edit[submit]"]').click();
	}
});

$(document).on('keydown', 'input[data-datagrid-manualsubmit]', function(e) {
	var code;
	code = e.which || e.keyCode || 0;
	if (code === 13) {
		e.stopPropagation();
		e.preventDefault();
		return dataGridSubmitForm($(this).closest('form').first());
	}
});

getEventDomPath = function(e) {
	var node, path;
	if (indexOf.call(e, path) >= 0) {
		return e.path;
	}
	path = [];
	node = e.target;
	while (node !== document.body) {
		if (node === null) {
			break;
		}
		path.push(node);
		node = node.parentNode;
	}
	return path;
};

datagridShiftGroupSelection = function() {
	var last_checkbox;
	last_checkbox = null;
	return document.addEventListener('click', function(e) {
		var checkboxes_rows, current_checkbox_row, el, event, i, ie, input, j, k, last_checkbox_row, last_checkbox_tbody, len, len1, len2, ref, ref1, results, row, rows;
		ref = getEventDomPath(e);
		for (i = 0, len = ref.length; i < len; i++) {
			el = ref[i];
			if ($(el).is('.col-checkbox') && last_checkbox && e.shiftKey) {
				current_checkbox_row = $(el).closest('tr');
				last_checkbox_row = last_checkbox.closest('tr');
				last_checkbox_tbody = last_checkbox_row.closest('tbody');
				checkboxes_rows = last_checkbox_tbody.find('tr').toArray();
				if (current_checkbox_row.index() > last_checkbox_row.index()) {
					rows = checkboxes_rows.slice(last_checkbox_row.index(), current_checkbox_row.index());
				} else if (current_checkbox_row.index() < last_checkbox_row.index()) {
					rows = checkboxes_rows.slice(current_checkbox_row.index() + 1, last_checkbox_row.index());
				}
				if (!rows) {
					return;
				}
				for (j = 0, len1 = rows.length; j < len1; j++) {
					row = rows[j];
					input = $(row).find('.col-checkbox input[type=checkbox]')[0];
					if (input) {
						input.checked = true;
						ie = window.navigator.userAgent.indexOf("MSIE ");
						if (ie) {
							event = document.createEvent('Event');
							event.initEvent('change', true, true);
						} else {
							event = new Event('change', {
								'bubbles': true
							});
						}
						input.dispatchEvent(event);
					}
				}
			}
		}
		ref1 = getEventDomPath(e);
		results = [];
		for (k = 0, len2 = ref1.length; k < len2; k++) {
			el = ref1[k];
			if ($(el).is('.col-checkbox')) {
				results.push(last_checkbox = $(el));
			} else {
				results.push(void 0);
			}
		}
		return results;
	});
};

datagridShiftGroupSelection();

document.addEventListener('change', function(e) {
	var buttons, checked_inputs, counter, event, grid, i, ie, input, inputs, len, results, select, total;
	grid = e.target.getAttribute('data-check');
	if (grid) {
		checked_inputs = document.querySelectorAll('input[data-check-all-' + grid + ']:checked');
		select = document.querySelector('.datagrid-' + grid + ' select[name="group_action[group_action]"]');
		buttons = document.querySelectorAll('.datagrid-' + grid + ' input[type="submit"]');
		if (buttons.length === 0) {
			buttons = document.querySelectorAll('.datagrid-' + grid + ' button[type="submit"]');
		}
		counter = document.querySelector('.datagrid-' + grid + ' .datagrid-selected-rows-count');

		if (checked_inputs.length) {
			if (buttons) {
				buttons.forEach(function (button) {
					button.disabled = false;
				});
			}
			if (select) {
				select.disabled = false;
			}
			total = document.querySelectorAll('input[data-check-all-' + grid + ']').length;
			if (counter) {
				counter.innerHTML = checked_inputs.length + '/' + total;
			}
		} else {
			if (buttons) {
				buttons.forEach(function (button) {
					button.disabled = true;
				});
			}
			if (select) {
				select.disabled = true;
				select.value = "";
			}
			if (counter) {
				counter.innerHTML = "";
			}
		}
		ie = window.navigator.userAgent.indexOf("MSIE ");
		if (ie) {
			event = document.createEvent('Event');
			event.initEvent('change', true, true);
		} else {
			event = new Event('change', {
				'bubbles': true
			});
		}
		if (select) {
			select.dispatchEvent(event);
		}
	}
	grid = e.target.getAttribute('data-check-all');
	if (grid) {
		inputs = document.querySelectorAll('input[type=checkbox][data-check-all-' + grid + ']');
		results = [];
		for (i = 0, len = inputs.length; i < len; i++) {
			input = inputs[i];
			input.checked = e.target.checked;
			ie = window.navigator.userAgent.indexOf("MSIE ");
			if (ie) {
				event = document.createEvent('Event');
				event.initEvent('change', true, true);
			} else {
				event = new Event('change', {
					'bubbles': true
				});
			}
			results.push(input.dispatchEvent(event));
		}
		return results;
	}
});


window.datagridSerializeUrl = function(obj, prefix) {
var str = [];
for(var p in obj) {
	if (obj.hasOwnProperty(p)) {
		var k = prefix ? prefix + "[" + p + "]" : p, v = obj[p];
		if (v !== null && v !== "") {
			if (typeof v == "object") {
				var r = window.datagridSerializeUrl(v, k);
					if (r) {
						str.push(r);
					}
			} else {
				str.push(encodeURIComponent(k) + "=" + encodeURIComponent(v));
			}
		}
	}
}
return str.join("&");
}
;

datagridSortable = function() {
	if (typeof $.fn.sortable === 'undefined') {
		return;
	}
	return $('.datagrid [data-sortable]').sortable({
		handle: '.handle-sort',
		items: 'tr',
		axis: 'y',
		update: function(event, ui) {
			var component_prefix, data, item_id, next_id, prev_id, row, url;
			row = ui.item.closest('tr[data-id]');
			item_id = row.data('id');
			prev_id = null;
			next_id = null;
			if (row.prev().length) {
				prev_id = row.prev().data('id');
			}
			if (row.next().length) {
				next_id = row.next().data('id');
			}
			url = $(this).data('sortable-url');
			data = {};
			component_prefix = row.closest('.datagrid').find('tbody').attr('data-sortable-parent-path');
			data[(component_prefix + '-item_id').replace(/^-/, '')] = item_id;
			if (prev_id !== null) {
				data[(component_prefix + '-prev_id').replace(/^-/, '')] = prev_id;
			}
			if (next_id !== null) {
				data[(component_prefix + '-next_id').replace(/^-/, '')] = next_id;
			}
			return dataGridRegisterAjaxCall({
				type: 'GET',
				url: url,
				data: data,
				error: function(jqXHR, textStatus, errorThrown) {
					return alert(jqXHR.statusText);
				}
			});
		},
		helper: function(e, ui) {
			ui.children().each(function() {
				return $(this).width($(this).width());
			});
			return ui;
		}
	});
};

$(function() {
	return datagridSortable();
});

if (typeof datagridSortableTree === 'undefined') {
	datagridSortableTree = function() {
		if (typeof $('.datagrid-tree-item-children').sortable === 'undefined') {
			return;
		}
		return $('.datagrid-tree-item-children').sortable({
			handle: '.handle-sort',
			items: '.datagrid-tree-item:not(.datagrid-tree-header)',
			toleranceElement: '> .datagrid-tree-item-content',
			connectWith: '.datagrid-tree-item-children',
			update: function(event, ui) {
				var component_prefix, data, item_id, next_id, parent, parent_id, prev_id, row, url;
				$('.toggle-tree-to-delete').remove();
				row = ui.item.closest('.datagrid-tree-item[data-id]');
				item_id = row.data('id');
				prev_id = null;
				next_id = null;
				parent_id = null;
				if (row.prev().length) {
					prev_id = row.prev().data('id');
				}
				if (row.next().length) {
					next_id = row.next().data('id');
				}
				parent = row.parent().closest('.datagrid-tree-item');
				if (parent.length) {
					parent.find('.datagrid-tree-item-children').first().css({
						display: 'block'
					});
					parent.addClass('has-children');
					parent_id = parent.data('id');
				}
				url = $(this).data('sortable-url');
				if (!url) {
					return;
				}
				parent.find('[data-toggle-tree]').first().removeClass('hidden');
				component_prefix = row.closest('.datagrid-tree').attr('data-sortable-parent-path');
				data = {};
				data[(component_prefix + '-item_id').replace(/^-/, '')] = item_id;
				if (prev_id !== null) {
					data[(component_prefix + '-prev_id').replace(/^-/, '')] = prev_id;
				}
				if (next_id !== null) {
					data[(component_prefix + '-next_id').replace(/^-/, '')] = next_id;
				}
				data[(component_prefix + '-parent_id').replace(/^-/, '')] = parent_id;
				return dataGridRegisterAjaxCall({
					type: 'GET',
					url: url,
					data: data,
					error: function(jqXHR, textStatus, errorThrown) {
						if (errorThrown !== 'abort') {
							return alert(jqXHR.statusText);
						}
					}
				});
			},
			stop: function(event, ui) {
				return $('.toggle-tree-to-delete').removeClass('toggle-tree-to-delete');
			},
			start: function(event, ui) {
				var parent;
				parent = ui.item.parent().closest('.datagrid-tree-item');
				if (parent.length) {
					if (parent.find('.datagrid-tree-item').length === 2) {
						return parent.find('[data-toggle-tree]').addClass('toggle-tree-to-delete');
					}
				}
			}
		});
	};
}

$(function() {
	return datagridSortableTree();
});

dataGridRegisterExtension('datagrid.happy', {
	success: function() {
		var c, checked_rows, class_selector, classes, event, grid, grids, i, ie, input, j, len, len1, results;
		if (window.happy) {
			window.happy.reset();
		}
		grids = $('.datagrid');
		results = [];
		for (i = 0, len = grids.length; i < len; i++) {
			grid = grids[i];
			classes = grid.classList;
			class_selector = '';
			for (j = 0, len1 = classes.length; j < len1; j++) {
				c = classes[j];
				class_selector = class_selector + '.' + c;
			}
			checked_rows = document.querySelectorAll(class_selector + ' ' + 'input[data-check]:checked');
			if (checked_rows.length === 1 && checked_rows[0].getAttribute('name') === 'toggle-all') {
				input = document.querySelector(class_selector + ' input[name=toggle-all]');
				if (input) {
					input.checked = false;
					ie = window.navigator.userAgent.indexOf("MSIE ");
					if (ie) {
						event = document.createEvent('Event');
						event.initEvent('change', true, true);
					} else {
						event = new Event('change', {
							'bubbles': true
						});
					}
					results.push(input.dispatchEvent(event));
				} else {
					results.push(void 0);
				}
			} else {
				results.push(void 0);
			}
		}
		return results;
	}
});

dataGridRegisterExtension('datagrid.sortable', {
	success: function() {
		return datagridSortable();
	}
});

dataGridRegisterExtension('datagrid.forms', {
	success: function() {
		return $('.datagrid').find('form').each(function() {
			return window.Nette.initForm(this);
		});
	}
});

dataGridRegisterExtension('datagrid.url', {
	success: function(payload) {
		var host, path, query, url;
		if (payload._datagrid_url) {
			if (window.history.replaceState) {
				host = window.location.protocol + "//" + window.location.host;
				path = window.location.pathname;
				query = window.datagridSerializeUrl(payload.state).replace(/&+$/gm, '');
				if (query) {
					url = host + path + "?" + query.replace(/\&*$/, '');
				} else {
					url = host + path;
				}
				url += window.location.hash;
				if (window.location.href !== url) {
					return window.history.replaceState({
						path: url
					}, '', url);
				}
			}
		}
	}
});

dataGridRegisterExtension('datagrid.sort', {
	success: function(payload) {
		var href, key, ref, results;
		if (payload._datagrid_sort) {
			ref = payload._datagrid_sort;
			results = [];
			for (key in ref) {
				href = ref[key];
				results.push($('#datagrid-sort-' + key).attr('href', href));
			}
			return results;
		}
	}
});

dataGridRegisterExtension('datargid.item_detail', {
	before: function(xhr, settings) {
		var id, row_detail, grid_fullname;
		if (settings.nette && settings.nette.el.attr('data-toggle-detail')) {
			id = settings.nette.el.attr('data-toggle-detail');
			grid_fullname = settings.nette.el.attr('data-toggle-detail-grid-fullname');
			row_detail = $('.item-detail-' + grid_fullname + '-id-' + id);
			if (row_detail.hasClass('loaded')) {
				if (!row_detail.find('.item-detail-content').length) {
					row_detail.removeClass('toggled');
					return true;
				}
				if (row_detail.hasClass('toggled')) {
					row_detail.find('.item-detail-content').slideToggle('fast', (function(_this) {
						return function() {
							return row_detail.toggleClass('toggled');
						};
					})(this));
				} else {
					row_detail.toggleClass('toggled');
					row_detail.find('.item-detail-content').slideToggle('fast');
				}
				return false;
			} else {
				return row_detail.addClass('loaded');
			}
		}
		return true;
	},
	success: function(payload) {
		var id, row_detail, grid_fullname;
		if (payload._datagrid_toggle_detail && payload._datagrid_name) {
			id = payload._datagrid_toggle_detail;
			grid_fullname = payload._datagrid_name;
			row_detail = $('.item-detail-' + grid_fullname + '-id-' + id);
			row_detail.toggleClass('toggled');
			return row_detail.find('.item-detail-content').slideToggle('fast');
		}
	}
});

dataGridRegisterExtension('datagrid.tree', {
	before: function(xhr, settings) {
		var children_block;
		if (settings.nette && settings.nette.el.attr('data-toggle-tree')) {
			settings.nette.el.toggleClass('toggle-rotate');
			children_block = settings.nette.el.closest('.datagrid-tree-item').find('.datagrid-tree-item-children').first();
			if (children_block.hasClass('loaded')) {
				children_block.slideToggle('fast');
				return false;
			}
		}
		return true;
	},
	success: function(payload) {
		var children_block, content, id, name, ref, snippet, template;
		if (payload._datagrid_tree) {
			id = payload._datagrid_tree;
			children_block = $('.datagrid-tree-item[data-id="' + id + '"]').find('.datagrid-tree-item-children').first();
			children_block.addClass('loaded');
			ref = payload.snippets;
			for (name in ref) {
				snippet = ref[name];
				content = $(snippet);
				template = $('<div class="datagrid-tree-item" id="' + name + '">');
				template.attr('data-id', content.attr('data-id'));
				template.append(content);
				if (content.data('has-children')) {
					template.addClass('has-children');
				}
				children_block.append(template);
			}
			children_block.addClass('loaded');
			children_block.slideToggle('fast');
			dataGridLoad();
		}
		return datagridSortableTree();
	}
});

$(document).on('click', '[data-datagrid-editable-url]', function(event) {
	var attr_name, attr_value, attrs, cell, cellValue, cell_height, cell_lines, cell_padding, input, line_height, submit, valueToEdit;
	cell = $(this);
	if (event.target.tagName.toLowerCase() === 'a') {
		return;
	}
	if (cell.hasClass('datagrid-inline-edit')) {
		return;
	}
	if (!cell.hasClass('editing')) {
		cell.addClass('editing');
		cellValue = cell.html().trim().replace('<br>', '\n');
		if (cell.attr('data-datagrid-editable-value')) {
			valueToEdit = cell.data('datagrid-editable-value');
		} else {
			valueToEdit = cellValue;
		}
		cell.data('originalValue', cellValue);
		cell.data('valueToEdit', valueToEdit);
		if (cell.data('datagrid-editable-type') === 'textarea') {
			input = $('<textarea>' + valueToEdit + '</textarea>');
			cell_padding = parseInt(cell.css('padding').replace(/[^-\d\.]/g, ''), 10);
			cell_height = cell.outerHeight();
			line_height = Math.round(parseFloat(cell.css('line-height')));
			cell_lines = (cell_height - (2 * cell_padding)) / line_height;
			input.attr('rows', Math.round(cell_lines));
		} else if (cell.data('datagrid-editable-type') === 'select') {
			input = $(cell.data('datagrid-editable-element'));
			input.find("option[value='" + valueToEdit + "']").prop('selected', true);
		} else {
			input = $('<input type="' + cell.data('datagrid-editable-type') + '">');
			input.val(valueToEdit);
		}
		attrs = cell.data('datagrid-editable-attrs');
		for (attr_name in attrs) {
			attr_value = attrs[attr_name];
			input.attr(attr_name, attr_value);
		}
		cell.removeClass('edited');
		cell.html(input);
		submit = function(cell, el) {
			var value;
			value = el.val();
			if (value !== cell.data('valueToEdit')) {
				dataGridRegisterAjaxCall({
					url: cell.data('datagrid-editable-url'),
					data: {
						value: value
					},
					type: 'POST',
					success: function(payload) {
						if (cell.data('datagrid-editable-type') === 'select') {
							cell.html(input.find("option[value='" + value + "']").html());
						} else {
							if (payload._datagrid_editable_new_value) {
								value = payload._datagrid_editable_new_value;
							}
							cell.html(value);
						}
						return cell.addClass('edited');
					},
					error: function() {
						cell.html(cell.data('originalValue'));
						return cell.addClass('edited-error');
					}
				});
			} else {
				cell.html(cell.data('originalValue'));
			}
			return setTimeout(function() {
				return cell.removeClass('editing');
			}, 1200);
		};
		cell.find('input,textarea,select').focus().on('blur', function() {
			return submit(cell, $(this));
		}).on('keydown', function(e) {
			if (cell.data('datagrid-editable-type') !== 'textarea') {
				if (e.which === 13) {
					e.stopPropagation();
					e.preventDefault();
					return submit(cell, $(this));
				}
			}
			if (e.which === 27) {
				e.stopPropagation();
				e.preventDefault();
				cell.removeClass('editing');
				return cell.html(cell.data('originalValue'));
			}
		});
		return cell.find('select').on('change', function() {
			return submit(cell, $(this));
		});
	}
});

dataGridRegisterExtension('datagrid.after_inline_edit', {
	success: function(payload) {
		var grid = $('.datagrid-' + payload._datagrid_name);

		if (payload._datagrid_inline_edited) {
			grid.find('tr[data-id=' + payload._datagrid_inline_edited + '] > td').addClass('edited');
			return grid.find('.datagrid-inline-edit-trigger').removeClass('hidden');
		} else if (payload._datagrid_inline_edit_cancel) {
			return grid.find('.datagrid-inline-edit-trigger').removeClass('hidden');
		}
	}
});

$(document).on('mouseup', '[data-datagrid-cancel-inline-add]', function(e) {
	var code = e.which || e.keyCode || 0;
	if (code === 1) {
		e.stopPropagation();
		e.preventDefault();
		return $('.datagrid-row-inline-add').addClass('datagrid-row-inline-add-hidden');
	}
});

dataGridRegisterExtension('datagrid-toggle-inline-add', {
	success: function(payload) {
		var grid = $('.datagrid-' + payload._datagrid_name);

		if (payload._datagrid_inline_adding) {
			var row = grid.find('.datagrid-row-inline-add');

			if (row.hasClass('datagrid-row-inline-add-hidden')) {
				row.removeClass('datagrid-row-inline-add-hidden');
			}

			row.find('input:not([readonly]),textarea:not([readonly])').first().focus();
		}
	}
});

datagridFitlerMultiSelect = function() {
	var select = $('.selectpicker').first();

	if ($.fn.selectpicker) {
		return $.fn.selectpicker.defaults = {
			countSelectedText: select.data('i18n-selected'),
			iconBase: '',
			tickIcon: select.data('selected-icon-check')
		};
	}
};

$(function() {
	return datagridFitlerMultiSelect();
});

datagridGroupActionMultiSelect = function() {
	var selects;

	if (!$.fn.selectpicker) {
		return;
	}

	selects = $('[data-datagrid-multiselect-id]');

	return selects.each(function() {
		var id;
		if ($(this).hasClass('selectpicker')) {
			$(this).removeAttr('id');
			id = $(this).data('datagrid-multiselect-id');
			$(this).on('loaded.bs.select', function(e) {
				$(this).parent().attr('style', 'display:none;');
				return $(this).parent().find('.hidden').removeClass('hidden').addClass('btn-default btn-secondary');
			});
			return $(this).on('rendered.bs.select', function(e) {
				return $(this).parent().attr('id', id);
			});
		}
	});
};

$(function() {
	return datagridGroupActionMultiSelect();
});

dataGridRegisterExtension('datagrid.fitlerMultiSelect', {
	success: function() {
		datagridFitlerMultiSelect();
		if ($.fn.selectpicker) {
			return $('.selectpicker').selectpicker({
				iconBase: 'fa'
			});
		}
	}
});

dataGridRegisterExtension('datagrid.groupActionMultiSelect', {
	success: function() {
		return datagridGroupActionMultiSelect();
	}
});

dataGridRegisterExtension('datagrid.inline-editing', {
	success: function(payload) {
		var grid;
		if (payload._datagrid_inline_editing) {
			grid = $('.datagrid-' + payload._datagrid_name);
			return grid.find('.datagrid-inline-edit-trigger').addClass('hidden');
		}
	}
});

dataGridRegisterExtension('datagrid.redraw-item', {
	success: function(payload) {
		var row;
		if (payload._datagrid_redraw_item_class) {
			row = $('tr[data-id=' + payload._datagrid_redraw_item_id + ']');
			return row.attr('class', payload._datagrid_redraw_item_class);
		}
	}
});

dataGridRegisterExtension('datagrid.reset-filter-by-column', {
	success: function(payload) {
		var grid, href, i, key, len, ref;
		if (!payload._datagrid_name) {
			return;
		}
		grid = $('.datagrid-' + payload._datagrid_name);
		grid.find('[data-datagrid-reset-filter-by-column]').addClass('hidden');
		if (payload.non_empty_filters && payload.non_empty_filters.length) {
			ref = payload.non_empty_filters;
			for (i = 0, len = ref.length; i < len; i++) {
				key = ref[i];
				grid.find('[data-datagrid-reset-filter-by-column=' + key + ']').removeClass('hidden');
			}
			href = grid.find('.reset-filter').attr('href');
			return grid.find('[data-datagrid-reset-filter-by-column]').each(function() {
				var new_href;
				key = $(this).attr('data-datagrid-reset-filter-by-column');
				new_href = href.replace('do=' + payload._datagrid_name + '-resetFilter', 'do=' + payload._datagrid_name + '-resetColumnFilter');
				new_href += '&' + payload._datagrid_name + '-key=' + key;
				return $(this).attr('href', new_href);
			});
		}
	}
});


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfY29yZS1qc19tb2R1bGVzX2VzX2FycmF5X2ZpbmRfanMtbm9kZV9tb2R1bGVzX3VibGFib28tZGF0YWdyaWRfYXNzZXRzX2RhLWRkYjk3OS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLHNCQUFzQixtQkFBTyxDQUFDLDZGQUFnQztBQUM5RCxhQUFhLG1CQUFPLENBQUMscUZBQTRCO0FBQ2pELDJCQUEyQixtQkFBTyxDQUFDLHVHQUFxQzs7QUFFeEU7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7Ozs7Ozs7Ozs7O0FDbkJBLFdBQVcsbUJBQU8sQ0FBQyxxR0FBb0M7QUFDdkQsb0JBQW9CLG1CQUFPLENBQUMsdUZBQTZCO0FBQ3pELGVBQWUsbUJBQU8sQ0FBQyw2RUFBd0I7QUFDL0MsZUFBZSxtQkFBTyxDQUFDLDZFQUF3QjtBQUMvQyx5QkFBeUIsbUJBQU8sQ0FBQyxtR0FBbUM7O0FBRXBFOztBQUVBLHNCQUFzQixrRUFBa0U7QUFDeEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsZ0JBQWdCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBLDRDQUE0QztBQUM1Qyw0Q0FBNEM7QUFDNUMsNENBQTRDO0FBQzVDLDRDQUE0QztBQUM1QyxVQUFVO0FBQ1YsNENBQTRDO0FBQzVDLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7QUN2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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7OztBQUdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLFlBQVksQ0FBQztBQUNiO0FBQ0E7QUFDQSxRQUFRLENBQUM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLENBQUM7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixHQUFHO0FBQ0g7QUFDQTtBQUNBLFdBQVcsQ0FBQyxhQUFhLENBQUM7QUFDMUIsSUFBSTtBQUNKO0FBQ0E7QUFDQSxFQUFFO0FBQ0Y7O0FBRUEsQ0FBQztBQUNEO0FBQ0EsQ0FBQzs7QUFFRDtBQUNBO0FBQ0EsYUFBYSxDQUFDO0FBQ2Q7QUFDQTtBQUNBLFNBQVMsQ0FBQztBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksQ0FBQztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQSxVQUFVLENBQUM7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLElBQUk7QUFDSjtBQUNBLFdBQVcsQ0FBQztBQUNaLElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FB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O0FBQ0E7QUFDQSxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL2FkZC10by11bnNjb3BhYmxlcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvYXJyYXktaXRlcmF0aW9uLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9hcnJheS1zcGVjaWVzLWNvbnN0cnVjdG9yLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9hcnJheS1zcGVjaWVzLWNyZWF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvY2xhc3NvZi5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvZnVuY3Rpb24tYmluZC1jb250ZXh0LmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9odG1sLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy9jb3JlLWpzL2ludGVybmFscy9pcy1hcnJheS5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvaXMtY29uc3RydWN0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL29iamVjdC1jcmVhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL29iamVjdC1kZWZpbmUtcHJvcGVydGllcy5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9pbnRlcm5hbHMvb2JqZWN0LWtleXMuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL2NvcmUtanMvaW50ZXJuYWxzL3RvLXN0cmluZy10YWctc3VwcG9ydC5qcyIsIndlYnBhY2s6Ly8vLi9ub2RlX21vZHVsZXMvY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQuanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3VibGFib28tZGF0YWdyaWQvYXNzZXRzL2RhdGFncmlkLWluc3RhbnQtdXJsLXJlZnJlc2guanMiLCJ3ZWJwYWNrOi8vLy4vbm9kZV9tb2R1bGVzL3VibGFib28tZGF0YWdyaWQvYXNzZXRzL2RhdGFncmlkLXNwaW5uZXJzLmpzIiwid2VicGFjazovLy8uL25vZGVfbW9kdWxlcy91YmxhYm9vLWRhdGFncmlkL2Fzc2V0cy9kYXRhZ3JpZC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgd2VsbEtub3duU3ltYm9sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3dlbGwta25vd24tc3ltYm9sJyk7XG52YXIgY3JlYXRlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL29iamVjdC1jcmVhdGUnKTtcbnZhciBkZWZpbmVQcm9wZXJ0eU1vZHVsZSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9vYmplY3QtZGVmaW5lLXByb3BlcnR5Jyk7XG5cbnZhciBVTlNDT1BBQkxFUyA9IHdlbGxLbm93blN5bWJvbCgndW5zY29wYWJsZXMnKTtcbnZhciBBcnJheVByb3RvdHlwZSA9IEFycmF5LnByb3RvdHlwZTtcblxuLy8gQXJyYXkucHJvdG90eXBlW0BAdW5zY29wYWJsZXNdXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS1AQHVuc2NvcGFibGVzXG5pZiAoQXJyYXlQcm90b3R5cGVbVU5TQ09QQUJMRVNdID09IHVuZGVmaW5lZCkge1xuICBkZWZpbmVQcm9wZXJ0eU1vZHVsZS5mKEFycmF5UHJvdG90eXBlLCBVTlNDT1BBQkxFUywge1xuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICB2YWx1ZTogY3JlYXRlKG51bGwpXG4gIH0pO1xufVxuXG4vLyBhZGQgYSBrZXkgdG8gQXJyYXkucHJvdG90eXBlW0BAdW5zY29wYWJsZXNdXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgQXJyYXlQcm90b3R5cGVbVU5TQ09QQUJMRVNdW2tleV0gPSB0cnVlO1xufTtcbiIsInZhciBiaW5kID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2Z1bmN0aW9uLWJpbmQtY29udGV4dCcpO1xudmFyIEluZGV4ZWRPYmplY3QgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaW5kZXhlZC1vYmplY3QnKTtcbnZhciB0b09iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1vYmplY3QnKTtcbnZhciB0b0xlbmd0aCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1sZW5ndGgnKTtcbnZhciBhcnJheVNwZWNpZXNDcmVhdGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvYXJyYXktc3BlY2llcy1jcmVhdGUnKTtcblxudmFyIHB1c2ggPSBbXS5wdXNoO1xuXG4vLyBgQXJyYXkucHJvdG90eXBlLnsgZm9yRWFjaCwgbWFwLCBmaWx0ZXIsIHNvbWUsIGV2ZXJ5LCBmaW5kLCBmaW5kSW5kZXgsIGZpbHRlclJlamVjdCB9YCBtZXRob2RzIGltcGxlbWVudGF0aW9uXG52YXIgY3JlYXRlTWV0aG9kID0gZnVuY3Rpb24gKFRZUEUpIHtcbiAgdmFyIElTX01BUCA9IFRZUEUgPT0gMTtcbiAgdmFyIElTX0ZJTFRFUiA9IFRZUEUgPT0gMjtcbiAgdmFyIElTX1NPTUUgPSBUWVBFID09IDM7XG4gIHZhciBJU19FVkVSWSA9IFRZUEUgPT0gNDtcbiAgdmFyIElTX0ZJTkRfSU5ERVggPSBUWVBFID09IDY7XG4gIHZhciBJU19GSUxURVJfUkVKRUNUID0gVFlQRSA9PSA3O1xuICB2YXIgTk9fSE9MRVMgPSBUWVBFID09IDUgfHwgSVNfRklORF9JTkRFWDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgkdGhpcywgY2FsbGJhY2tmbiwgdGhhdCwgc3BlY2lmaWNDcmVhdGUpIHtcbiAgICB2YXIgTyA9IHRvT2JqZWN0KCR0aGlzKTtcbiAgICB2YXIgc2VsZiA9IEluZGV4ZWRPYmplY3QoTyk7XG4gICAgdmFyIGJvdW5kRnVuY3Rpb24gPSBiaW5kKGNhbGxiYWNrZm4sIHRoYXQsIDMpO1xuICAgIHZhciBsZW5ndGggPSB0b0xlbmd0aChzZWxmLmxlbmd0aCk7XG4gICAgdmFyIGluZGV4ID0gMDtcbiAgICB2YXIgY3JlYXRlID0gc3BlY2lmaWNDcmVhdGUgfHwgYXJyYXlTcGVjaWVzQ3JlYXRlO1xuICAgIHZhciB0YXJnZXQgPSBJU19NQVAgPyBjcmVhdGUoJHRoaXMsIGxlbmd0aCkgOiBJU19GSUxURVIgfHwgSVNfRklMVEVSX1JFSkVDVCA/IGNyZWF0ZSgkdGhpcywgMCkgOiB1bmRlZmluZWQ7XG4gICAgdmFyIHZhbHVlLCByZXN1bHQ7XG4gICAgZm9yICg7bGVuZ3RoID4gaW5kZXg7IGluZGV4KyspIGlmIChOT19IT0xFUyB8fCBpbmRleCBpbiBzZWxmKSB7XG4gICAgICB2YWx1ZSA9IHNlbGZbaW5kZXhdO1xuICAgICAgcmVzdWx0ID0gYm91bmRGdW5jdGlvbih2YWx1ZSwgaW5kZXgsIE8pO1xuICAgICAgaWYgKFRZUEUpIHtcbiAgICAgICAgaWYgKElTX01BUCkgdGFyZ2V0W2luZGV4XSA9IHJlc3VsdDsgLy8gbWFwXG4gICAgICAgIGVsc2UgaWYgKHJlc3VsdCkgc3dpdGNoIChUWVBFKSB7XG4gICAgICAgICAgY2FzZSAzOiByZXR1cm4gdHJ1ZTsgICAgICAgICAgICAgIC8vIHNvbWVcbiAgICAgICAgICBjYXNlIDU6IHJldHVybiB2YWx1ZTsgICAgICAgICAgICAgLy8gZmluZFxuICAgICAgICAgIGNhc2UgNjogcmV0dXJuIGluZGV4OyAgICAgICAgICAgICAvLyBmaW5kSW5kZXhcbiAgICAgICAgICBjYXNlIDI6IHB1c2guY2FsbCh0YXJnZXQsIHZhbHVlKTsgLy8gZmlsdGVyXG4gICAgICAgIH0gZWxzZSBzd2l0Y2ggKFRZUEUpIHtcbiAgICAgICAgICBjYXNlIDQ6IHJldHVybiBmYWxzZTsgICAgICAgICAgICAgLy8gZXZlcnlcbiAgICAgICAgICBjYXNlIDc6IHB1c2guY2FsbCh0YXJnZXQsIHZhbHVlKTsgLy8gZmlsdGVyUmVqZWN0XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIElTX0ZJTkRfSU5ERVggPyAtMSA6IElTX1NPTUUgfHwgSVNfRVZFUlkgPyBJU19FVkVSWSA6IHRhcmdldDtcbiAgfTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICAvLyBgQXJyYXkucHJvdG90eXBlLmZvckVhY2hgIG1ldGhvZFxuICAvLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5mb3JlYWNoXG4gIGZvckVhY2g6IGNyZWF0ZU1ldGhvZCgwKSxcbiAgLy8gYEFycmF5LnByb3RvdHlwZS5tYXBgIG1ldGhvZFxuICAvLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5tYXBcbiAgbWFwOiBjcmVhdGVNZXRob2QoMSksXG4gIC8vIGBBcnJheS5wcm90b3R5cGUuZmlsdGVyYCBtZXRob2RcbiAgLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUuZmlsdGVyXG4gIGZpbHRlcjogY3JlYXRlTWV0aG9kKDIpLFxuICAvLyBgQXJyYXkucHJvdG90eXBlLnNvbWVgIG1ldGhvZFxuICAvLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5zb21lXG4gIHNvbWU6IGNyZWF0ZU1ldGhvZCgzKSxcbiAgLy8gYEFycmF5LnByb3RvdHlwZS5ldmVyeWAgbWV0aG9kXG4gIC8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmV2ZXJ5XG4gIGV2ZXJ5OiBjcmVhdGVNZXRob2QoNCksXG4gIC8vIGBBcnJheS5wcm90b3R5cGUuZmluZGAgbWV0aG9kXG4gIC8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmZpbmRcbiAgZmluZDogY3JlYXRlTWV0aG9kKDUpLFxuICAvLyBgQXJyYXkucHJvdG90eXBlLmZpbmRJbmRleGAgbWV0aG9kXG4gIC8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtYXJyYXkucHJvdG90eXBlLmZpbmRJbmRleFxuICBmaW5kSW5kZXg6IGNyZWF0ZU1ldGhvZCg2KSxcbiAgLy8gYEFycmF5LnByb3RvdHlwZS5maWx0ZXJSZWplY3RgIG1ldGhvZFxuICAvLyBodHRwczovL2dpdGh1Yi5jb20vdGMzOS9wcm9wb3NhbC1hcnJheS1maWx0ZXJpbmdcbiAgZmlsdGVyUmVqZWN0OiBjcmVhdGVNZXRob2QoNylcbn07XG4iLCJ2YXIgaXNBcnJheSA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pcy1hcnJheScpO1xudmFyIGlzQ29uc3RydWN0b3IgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaXMtY29uc3RydWN0b3InKTtcbnZhciBpc09iamVjdCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9pcy1vYmplY3QnKTtcbnZhciB3ZWxsS25vd25TeW1ib2wgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvd2VsbC1rbm93bi1zeW1ib2wnKTtcblxudmFyIFNQRUNJRVMgPSB3ZWxsS25vd25TeW1ib2woJ3NwZWNpZXMnKTtcblxuLy8gYSBwYXJ0IG9mIGBBcnJheVNwZWNpZXNDcmVhdGVgIGFic3RyYWN0IG9wZXJhdGlvblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheXNwZWNpZXNjcmVhdGVcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9yaWdpbmFsQXJyYXkpIHtcbiAgdmFyIEM7XG4gIGlmIChpc0FycmF5KG9yaWdpbmFsQXJyYXkpKSB7XG4gICAgQyA9IG9yaWdpbmFsQXJyYXkuY29uc3RydWN0b3I7XG4gICAgLy8gY3Jvc3MtcmVhbG0gZmFsbGJhY2tcbiAgICBpZiAoaXNDb25zdHJ1Y3RvcihDKSAmJiAoQyA9PT0gQXJyYXkgfHwgaXNBcnJheShDLnByb3RvdHlwZSkpKSBDID0gdW5kZWZpbmVkO1xuICAgIGVsc2UgaWYgKGlzT2JqZWN0KEMpKSB7XG4gICAgICBDID0gQ1tTUEVDSUVTXTtcbiAgICAgIGlmIChDID09PSBudWxsKSBDID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfSByZXR1cm4gQyA9PT0gdW5kZWZpbmVkID8gQXJyYXkgOiBDO1xufTtcbiIsInZhciBhcnJheVNwZWNpZXNDb25zdHJ1Y3RvciA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hcnJheS1zcGVjaWVzLWNvbnN0cnVjdG9yJyk7XG5cbi8vIGBBcnJheVNwZWNpZXNDcmVhdGVgIGFic3RyYWN0IG9wZXJhdGlvblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheXNwZWNpZXNjcmVhdGVcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9yaWdpbmFsQXJyYXksIGxlbmd0aCkge1xuICByZXR1cm4gbmV3IChhcnJheVNwZWNpZXNDb25zdHJ1Y3RvcihvcmlnaW5hbEFycmF5KSkobGVuZ3RoID09PSAwID8gMCA6IGxlbmd0aCk7XG59O1xuIiwidmFyIFRPX1NUUklOR19UQUdfU1VQUE9SVCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy90by1zdHJpbmctdGFnLXN1cHBvcnQnKTtcbnZhciBpc0NhbGxhYmxlID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2lzLWNhbGxhYmxlJyk7XG52YXIgY2xhc3NvZlJhdyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jbGFzc29mLXJhdycpO1xudmFyIHdlbGxLbm93blN5bWJvbCA9IHJlcXVpcmUoJy4uL2ludGVybmFscy93ZWxsLWtub3duLXN5bWJvbCcpO1xuXG52YXIgVE9fU1RSSU5HX1RBRyA9IHdlbGxLbm93blN5bWJvbCgndG9TdHJpbmdUYWcnKTtcbi8vIEVTMyB3cm9uZyBoZXJlXG52YXIgQ09SUkVDVF9BUkdVTUVOVFMgPSBjbGFzc29mUmF3KGZ1bmN0aW9uICgpIHsgcmV0dXJuIGFyZ3VtZW50czsgfSgpKSA9PSAnQXJndW1lbnRzJztcblxuLy8gZmFsbGJhY2sgZm9yIElFMTEgU2NyaXB0IEFjY2VzcyBEZW5pZWQgZXJyb3JcbnZhciB0cnlHZXQgPSBmdW5jdGlvbiAoaXQsIGtleSkge1xuICB0cnkge1xuICAgIHJldHVybiBpdFtrZXldO1xuICB9IGNhdGNoIChlcnJvcikgeyAvKiBlbXB0eSAqLyB9XG59O1xuXG4vLyBnZXR0aW5nIHRhZyBmcm9tIEVTNisgYE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmdgXG5tb2R1bGUuZXhwb3J0cyA9IFRPX1NUUklOR19UQUdfU1VQUE9SVCA/IGNsYXNzb2ZSYXcgOiBmdW5jdGlvbiAoaXQpIHtcbiAgdmFyIE8sIHRhZywgcmVzdWx0O1xuICByZXR1cm4gaXQgPT09IHVuZGVmaW5lZCA/ICdVbmRlZmluZWQnIDogaXQgPT09IG51bGwgPyAnTnVsbCdcbiAgICAvLyBAQHRvU3RyaW5nVGFnIGNhc2VcbiAgICA6IHR5cGVvZiAodGFnID0gdHJ5R2V0KE8gPSBPYmplY3QoaXQpLCBUT19TVFJJTkdfVEFHKSkgPT0gJ3N0cmluZycgPyB0YWdcbiAgICAvLyBidWlsdGluVGFnIGNhc2VcbiAgICA6IENPUlJFQ1RfQVJHVU1FTlRTID8gY2xhc3NvZlJhdyhPKVxuICAgIC8vIEVTMyBhcmd1bWVudHMgZmFsbGJhY2tcbiAgICA6IChyZXN1bHQgPSBjbGFzc29mUmF3KE8pKSA9PSAnT2JqZWN0JyAmJiBpc0NhbGxhYmxlKE8uY2FsbGVlKSA/ICdBcmd1bWVudHMnIDogcmVzdWx0O1xufTtcbiIsInZhciBhQ2FsbGFibGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvYS1jYWxsYWJsZScpO1xuXG4vLyBvcHRpb25hbCAvIHNpbXBsZSBjb250ZXh0IGJpbmRpbmdcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCB0aGF0LCBsZW5ndGgpIHtcbiAgYUNhbGxhYmxlKGZuKTtcbiAgaWYgKHRoYXQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZuO1xuICBzd2l0Y2ggKGxlbmd0aCkge1xuICAgIGNhc2UgMDogcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQpO1xuICAgIH07XG4gICAgY2FzZSAxOiByZXR1cm4gZnVuY3Rpb24gKGEpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEpO1xuICAgIH07XG4gICAgY2FzZSAyOiByZXR1cm4gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIpO1xuICAgIH07XG4gICAgY2FzZSAzOiByZXR1cm4gZnVuY3Rpb24gKGEsIGIsIGMpIHtcbiAgICAgIHJldHVybiBmbi5jYWxsKHRoYXQsIGEsIGIsIGMpO1xuICAgIH07XG4gIH1cbiAgcmV0dXJuIGZ1bmN0aW9uICgvKiAuLi5hcmdzICovKSB7XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoYXQsIGFyZ3VtZW50cyk7XG4gIH07XG59O1xuIiwidmFyIGdldEJ1aWx0SW4gPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZ2V0LWJ1aWx0LWluJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZ2V0QnVpbHRJbignZG9jdW1lbnQnLCAnZG9jdW1lbnRFbGVtZW50Jyk7XG4iLCJ2YXIgY2xhc3NvZiA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9jbGFzc29mLXJhdycpO1xuXG4vLyBgSXNBcnJheWAgYWJzdHJhY3Qgb3BlcmF0aW9uXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWlzYXJyYXlcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcy9uby1hcnJheS1pc2FycmF5IC0tIHNhZmVcbm1vZHVsZS5leHBvcnRzID0gQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiBpc0FycmF5KGFyZ3VtZW50KSB7XG4gIHJldHVybiBjbGFzc29mKGFyZ3VtZW50KSA9PSAnQXJyYXknO1xufTtcbiIsInZhciBmYWlscyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9mYWlscycpO1xudmFyIGlzQ2FsbGFibGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaXMtY2FsbGFibGUnKTtcbnZhciBjbGFzc29mID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2NsYXNzb2YnKTtcbnZhciBnZXRCdWlsdEluID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2dldC1idWlsdC1pbicpO1xudmFyIGluc3BlY3RTb3VyY2UgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaW5zcGVjdC1zb3VyY2UnKTtcblxudmFyIGVtcHR5ID0gW107XG52YXIgY29uc3RydWN0ID0gZ2V0QnVpbHRJbignUmVmbGVjdCcsICdjb25zdHJ1Y3QnKTtcbnZhciBjb25zdHJ1Y3RvclJlZ0V4cCA9IC9eXFxzKig/OmNsYXNzfGZ1bmN0aW9uKVxcYi87XG52YXIgZXhlYyA9IGNvbnN0cnVjdG9yUmVnRXhwLmV4ZWM7XG52YXIgSU5DT1JSRUNUX1RPX1NUUklORyA9ICFjb25zdHJ1Y3RvclJlZ0V4cC5leGVjKGZ1bmN0aW9uICgpIHsgLyogZW1wdHkgKi8gfSk7XG5cbnZhciBpc0NvbnN0cnVjdG9yTW9kZXJuID0gZnVuY3Rpb24gKGFyZ3VtZW50KSB7XG4gIGlmICghaXNDYWxsYWJsZShhcmd1bWVudCkpIHJldHVybiBmYWxzZTtcbiAgdHJ5IHtcbiAgICBjb25zdHJ1Y3QoT2JqZWN0LCBlbXB0eSwgYXJndW1lbnQpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxudmFyIGlzQ29uc3RydWN0b3JMZWdhY3kgPSBmdW5jdGlvbiAoYXJndW1lbnQpIHtcbiAgaWYgKCFpc0NhbGxhYmxlKGFyZ3VtZW50KSkgcmV0dXJuIGZhbHNlO1xuICBzd2l0Y2ggKGNsYXNzb2YoYXJndW1lbnQpKSB7XG4gICAgY2FzZSAnQXN5bmNGdW5jdGlvbic6XG4gICAgY2FzZSAnR2VuZXJhdG9yRnVuY3Rpb24nOlxuICAgIGNhc2UgJ0FzeW5jR2VuZXJhdG9yRnVuY3Rpb24nOiByZXR1cm4gZmFsc2U7XG4gICAgLy8gd2UgY2FuJ3QgY2hlY2sgLnByb3RvdHlwZSBzaW5jZSBjb25zdHJ1Y3RvcnMgcHJvZHVjZWQgYnkgLmJpbmQgaGF2ZW4ndCBpdFxuICB9IHJldHVybiBJTkNPUlJFQ1RfVE9fU1RSSU5HIHx8ICEhZXhlYy5jYWxsKGNvbnN0cnVjdG9yUmVnRXhwLCBpbnNwZWN0U291cmNlKGFyZ3VtZW50KSk7XG59O1xuXG4vLyBgSXNDb25zdHJ1Y3RvcmAgYWJzdHJhY3Qgb3BlcmF0aW9uXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWlzY29uc3RydWN0b3Jcbm1vZHVsZS5leHBvcnRzID0gIWNvbnN0cnVjdCB8fCBmYWlscyhmdW5jdGlvbiAoKSB7XG4gIHZhciBjYWxsZWQ7XG4gIHJldHVybiBpc0NvbnN0cnVjdG9yTW9kZXJuKGlzQ29uc3RydWN0b3JNb2Rlcm4uY2FsbClcbiAgICB8fCAhaXNDb25zdHJ1Y3Rvck1vZGVybihPYmplY3QpXG4gICAgfHwgIWlzQ29uc3RydWN0b3JNb2Rlcm4oZnVuY3Rpb24gKCkgeyBjYWxsZWQgPSB0cnVlOyB9KVxuICAgIHx8IGNhbGxlZDtcbn0pID8gaXNDb25zdHJ1Y3RvckxlZ2FjeSA6IGlzQ29uc3RydWN0b3JNb2Rlcm47XG4iLCIvKiBnbG9iYWwgQWN0aXZlWE9iamVjdCAtLSBvbGQgSUUsIFdTSCAqL1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FuLW9iamVjdCcpO1xudmFyIGRlZmluZVByb3BlcnRpZXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0aWVzJyk7XG52YXIgZW51bUJ1Z0tleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZW51bS1idWcta2V5cycpO1xudmFyIGhpZGRlbktleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvaGlkZGVuLWtleXMnKTtcbnZhciBodG1sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2h0bWwnKTtcbnZhciBkb2N1bWVudENyZWF0ZUVsZW1lbnQgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvZG9jdW1lbnQtY3JlYXRlLWVsZW1lbnQnKTtcbnZhciBzaGFyZWRLZXkgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvc2hhcmVkLWtleScpO1xuXG52YXIgR1QgPSAnPic7XG52YXIgTFQgPSAnPCc7XG52YXIgUFJPVE9UWVBFID0gJ3Byb3RvdHlwZSc7XG52YXIgU0NSSVBUID0gJ3NjcmlwdCc7XG52YXIgSUVfUFJPVE8gPSBzaGFyZWRLZXkoJ0lFX1BST1RPJyk7XG5cbnZhciBFbXB0eUNvbnN0cnVjdG9yID0gZnVuY3Rpb24gKCkgeyAvKiBlbXB0eSAqLyB9O1xuXG52YXIgc2NyaXB0VGFnID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgcmV0dXJuIExUICsgU0NSSVBUICsgR1QgKyBjb250ZW50ICsgTFQgKyAnLycgKyBTQ1JJUFQgKyBHVDtcbn07XG5cbi8vIENyZWF0ZSBvYmplY3Qgd2l0aCBmYWtlIGBudWxsYCBwcm90b3R5cGU6IHVzZSBBY3RpdmVYIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlXG52YXIgTnVsbFByb3RvT2JqZWN0VmlhQWN0aXZlWCA9IGZ1bmN0aW9uIChhY3RpdmVYRG9jdW1lbnQpIHtcbiAgYWN0aXZlWERvY3VtZW50LndyaXRlKHNjcmlwdFRhZygnJykpO1xuICBhY3RpdmVYRG9jdW1lbnQuY2xvc2UoKTtcbiAgdmFyIHRlbXAgPSBhY3RpdmVYRG9jdW1lbnQucGFyZW50V2luZG93Lk9iamVjdDtcbiAgYWN0aXZlWERvY3VtZW50ID0gbnVsbDsgLy8gYXZvaWQgbWVtb3J5IGxlYWtcbiAgcmV0dXJuIHRlbXA7XG59O1xuXG4vLyBDcmVhdGUgb2JqZWN0IHdpdGggZmFrZSBgbnVsbGAgcHJvdG90eXBlOiB1c2UgaWZyYW1lIE9iamVjdCB3aXRoIGNsZWFyZWQgcHJvdG90eXBlXG52YXIgTnVsbFByb3RvT2JqZWN0VmlhSUZyYW1lID0gZnVuY3Rpb24gKCkge1xuICAvLyBUaHJhc2gsIHdhc3RlIGFuZCBzb2RvbXk6IElFIEdDIGJ1Z1xuICB2YXIgaWZyYW1lID0gZG9jdW1lbnRDcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgdmFyIEpTID0gJ2phdmEnICsgU0NSSVBUICsgJzonO1xuICB2YXIgaWZyYW1lRG9jdW1lbnQ7XG4gIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICBodG1sLmFwcGVuZENoaWxkKGlmcmFtZSk7XG4gIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2lzc3Vlcy80NzVcbiAgaWZyYW1lLnNyYyA9IFN0cmluZyhKUyk7XG4gIGlmcmFtZURvY3VtZW50ID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQ7XG4gIGlmcmFtZURvY3VtZW50Lm9wZW4oKTtcbiAgaWZyYW1lRG9jdW1lbnQud3JpdGUoc2NyaXB0VGFnKCdkb2N1bWVudC5GPU9iamVjdCcpKTtcbiAgaWZyYW1lRG9jdW1lbnQuY2xvc2UoKTtcbiAgcmV0dXJuIGlmcmFtZURvY3VtZW50LkY7XG59O1xuXG4vLyBDaGVjayBmb3IgZG9jdW1lbnQuZG9tYWluIGFuZCBhY3RpdmUgeCBzdXBwb3J0XG4vLyBObyBuZWVkIHRvIHVzZSBhY3RpdmUgeCBhcHByb2FjaCB3aGVuIGRvY3VtZW50LmRvbWFpbiBpcyBub3Qgc2V0XG4vLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2VzLXNoaW1zL2VzNS1zaGltL2lzc3Vlcy8xNTBcbi8vIHZhcmlhdGlvbiBvZiBodHRwczovL2dpdGh1Yi5jb20va2l0Y2FtYnJpZGdlL2VzNS1zaGltL2NvbW1pdC80ZjczOGFjMDY2MzQ2XG4vLyBhdm9pZCBJRSBHQyBidWdcbnZhciBhY3RpdmVYRG9jdW1lbnQ7XG52YXIgTnVsbFByb3RvT2JqZWN0ID0gZnVuY3Rpb24gKCkge1xuICB0cnkge1xuICAgIGFjdGl2ZVhEb2N1bWVudCA9IG5ldyBBY3RpdmVYT2JqZWN0KCdodG1sZmlsZScpO1xuICB9IGNhdGNoIChlcnJvcikgeyAvKiBpZ25vcmUgKi8gfVxuICBOdWxsUHJvdG9PYmplY3QgPSB0eXBlb2YgZG9jdW1lbnQgIT0gJ3VuZGVmaW5lZCdcbiAgICA/IGRvY3VtZW50LmRvbWFpbiAmJiBhY3RpdmVYRG9jdW1lbnRcbiAgICAgID8gTnVsbFByb3RvT2JqZWN0VmlhQWN0aXZlWChhY3RpdmVYRG9jdW1lbnQpIC8vIG9sZCBJRVxuICAgICAgOiBOdWxsUHJvdG9PYmplY3RWaWFJRnJhbWUoKVxuICAgIDogTnVsbFByb3RvT2JqZWN0VmlhQWN0aXZlWChhY3RpdmVYRG9jdW1lbnQpOyAvLyBXU0hcbiAgdmFyIGxlbmd0aCA9IGVudW1CdWdLZXlzLmxlbmd0aDtcbiAgd2hpbGUgKGxlbmd0aC0tKSBkZWxldGUgTnVsbFByb3RvT2JqZWN0W1BST1RPVFlQRV1bZW51bUJ1Z0tleXNbbGVuZ3RoXV07XG4gIHJldHVybiBOdWxsUHJvdG9PYmplY3QoKTtcbn07XG5cbmhpZGRlbktleXNbSUVfUFJPVE9dID0gdHJ1ZTtcblxuLy8gYE9iamVjdC5jcmVhdGVgIG1ldGhvZFxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1vYmplY3QuY3JlYXRlXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5jcmVhdGUgfHwgZnVuY3Rpb24gY3JlYXRlKE8sIFByb3BlcnRpZXMpIHtcbiAgdmFyIHJlc3VsdDtcbiAgaWYgKE8gIT09IG51bGwpIHtcbiAgICBFbXB0eUNvbnN0cnVjdG9yW1BST1RPVFlQRV0gPSBhbk9iamVjdChPKTtcbiAgICByZXN1bHQgPSBuZXcgRW1wdHlDb25zdHJ1Y3RvcigpO1xuICAgIEVtcHR5Q29uc3RydWN0b3JbUFJPVE9UWVBFXSA9IG51bGw7XG4gICAgLy8gYWRkIFwiX19wcm90b19fXCIgZm9yIE9iamVjdC5nZXRQcm90b3R5cGVPZiBwb2x5ZmlsbFxuICAgIHJlc3VsdFtJRV9QUk9UT10gPSBPO1xuICB9IGVsc2UgcmVzdWx0ID0gTnVsbFByb3RvT2JqZWN0KCk7XG4gIHJldHVybiBQcm9wZXJ0aWVzID09PSB1bmRlZmluZWQgPyByZXN1bHQgOiBkZWZpbmVQcm9wZXJ0aWVzKHJlc3VsdCwgUHJvcGVydGllcyk7XG59O1xuIiwidmFyIERFU0NSSVBUT1JTID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2Rlc2NyaXB0b3JzJyk7XG52YXIgZGVmaW5lUHJvcGVydHlNb2R1bGUgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWRlZmluZS1wcm9wZXJ0eScpO1xudmFyIGFuT2JqZWN0ID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FuLW9iamVjdCcpO1xudmFyIG9iamVjdEtleXMgPSByZXF1aXJlKCcuLi9pbnRlcm5hbHMvb2JqZWN0LWtleXMnKTtcblxuLy8gYE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzYCBtZXRob2Rcbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtb2JqZWN0LmRlZmluZXByb3BlcnRpZXNcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcy9uby1vYmplY3QtZGVmaW5lcHJvcGVydGllcyAtLSBzYWZlXG5tb2R1bGUuZXhwb3J0cyA9IERFU0NSSVBUT1JTID8gT2JqZWN0LmRlZmluZVByb3BlcnRpZXMgOiBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKE8sIFByb3BlcnRpZXMpIHtcbiAgYW5PYmplY3QoTyk7XG4gIHZhciBrZXlzID0gb2JqZWN0S2V5cyhQcm9wZXJ0aWVzKTtcbiAgdmFyIGxlbmd0aCA9IGtleXMubGVuZ3RoO1xuICB2YXIgaW5kZXggPSAwO1xuICB2YXIga2V5O1xuICB3aGlsZSAobGVuZ3RoID4gaW5kZXgpIGRlZmluZVByb3BlcnR5TW9kdWxlLmYoTywga2V5ID0ga2V5c1tpbmRleCsrXSwgUHJvcGVydGllc1trZXldKTtcbiAgcmV0dXJuIE87XG59O1xuIiwidmFyIGludGVybmFsT2JqZWN0S2V5cyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9vYmplY3Qta2V5cy1pbnRlcm5hbCcpO1xudmFyIGVudW1CdWdLZXlzID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2VudW0tYnVnLWtleXMnKTtcblxuLy8gYE9iamVjdC5rZXlzYCBtZXRob2Rcbi8vIGh0dHBzOi8vdGMzOS5lcy9lY21hMjYyLyNzZWMtb2JqZWN0LmtleXNcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcy9uby1vYmplY3Qta2V5cyAtLSBzYWZlXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdC5rZXlzIHx8IGZ1bmN0aW9uIGtleXMoTykge1xuICByZXR1cm4gaW50ZXJuYWxPYmplY3RLZXlzKE8sIGVudW1CdWdLZXlzKTtcbn07XG4iLCJ2YXIgd2VsbEtub3duU3ltYm9sID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL3dlbGwta25vd24tc3ltYm9sJyk7XG5cbnZhciBUT19TVFJJTkdfVEFHID0gd2VsbEtub3duU3ltYm9sKCd0b1N0cmluZ1RhZycpO1xudmFyIHRlc3QgPSB7fTtcblxudGVzdFtUT19TVFJJTkdfVEFHXSA9ICd6JztcblxubW9kdWxlLmV4cG9ydHMgPSBTdHJpbmcodGVzdCkgPT09ICdbb2JqZWN0IHpdJztcbiIsIid1c2Ugc3RyaWN0JztcbnZhciAkID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2V4cG9ydCcpO1xudmFyICRmaW5kID0gcmVxdWlyZSgnLi4vaW50ZXJuYWxzL2FycmF5LWl0ZXJhdGlvbicpLmZpbmQ7XG52YXIgYWRkVG9VbnNjb3BhYmxlcyA9IHJlcXVpcmUoJy4uL2ludGVybmFscy9hZGQtdG8tdW5zY29wYWJsZXMnKTtcblxudmFyIEZJTkQgPSAnZmluZCc7XG52YXIgU0tJUFNfSE9MRVMgPSB0cnVlO1xuXG4vLyBTaG91bGRuJ3Qgc2tpcCBob2xlc1xuaWYgKEZJTkQgaW4gW10pIEFycmF5KDEpW0ZJTkRdKGZ1bmN0aW9uICgpIHsgU0tJUFNfSE9MRVMgPSBmYWxzZTsgfSk7XG5cbi8vIGBBcnJheS5wcm90b3R5cGUuZmluZGAgbWV0aG9kXG4vLyBodHRwczovL3RjMzkuZXMvZWNtYTI2Mi8jc2VjLWFycmF5LnByb3RvdHlwZS5maW5kXG4kKHsgdGFyZ2V0OiAnQXJyYXknLCBwcm90bzogdHJ1ZSwgZm9yY2VkOiBTS0lQU19IT0xFUyB9LCB7XG4gIGZpbmQ6IGZ1bmN0aW9uIGZpbmQoY2FsbGJhY2tmbiAvKiAsIHRoYXQgPSB1bmRlZmluZWQgKi8pIHtcbiAgICByZXR1cm4gJGZpbmQodGhpcywgY2FsbGJhY2tmbiwgYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBhcmd1bWVudHNbMV0gOiB1bmRlZmluZWQpO1xuICB9XG59KTtcblxuLy8gaHR0cHM6Ly90YzM5LmVzL2VjbWEyNjIvI3NlYy1hcnJheS5wcm90b3R5cGUtQEB1bnNjb3BhYmxlc1xuYWRkVG9VbnNjb3BhYmxlcyhGSU5EKTtcbiIsInZhciBkYXRhR3JpZFJlZ2lzdGVyQWpheENhbGw7XG5cbmlmICh0eXBlb2YgbmFqYSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRkYXRhR3JpZFJlZ2lzdGVyQWpheENhbGwgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG5cdFx0dmFyIG1ldGhvZCA9IHBhcmFtcy50eXBlIHx8ICdHRVQnO1xuXHRcdHZhciBkYXRhID0gcGFyYW1zLmRhdGEgfHwgbnVsbDtcblxuXHRcdG5hamEubWFrZVJlcXVlc3QobWV0aG9kLCBwYXJhbXMudXJsLCBkYXRhLCB7XG5cdFx0XHRoaXN0b3J5OiAncmVwbGFjZSdcblx0XHR9KVxuXHRcdFx0LnRoZW4ocGFyYW1zLnN1Y2Nlc3MpXG5cdFx0XHQuY2F0Y2gocGFyYW1zLmVycm9yKTtcblx0fTtcblxufSBlbHNlIHtcblx0XHRkYXRhR3JpZFJlZ2lzdGVyQWpheENhbGwgPSBmdW5jdGlvbiAocGFyYW1zKSB7XG5cdFx0XHQkLm5ldHRlLmFqYXgocGFyYW1zKTtcblx0XHR9O1xufVxuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZnVuY3Rpb24gKCkge1xuXHR2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kYXRhZ3JpZCcpO1xuXG5cdGlmIChlbGVtZW50ICE9PSBudWxsKSB7XG5cdFx0cmV0dXJuIGRhdGFHcmlkUmVnaXN0ZXJBamF4Q2FsbCh7XG5cdFx0XHR0eXBlOiAnR0VUJyxcblx0XHRcdHVybDogZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcmVmcmVzaC1zdGF0ZScpXG5cdFx0fSk7XG5cdH1cbn0pO1xuIiwidmFyIGRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb247XG5cbmlmICh0eXBlb2YgbmFqYSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHR2YXIgaXNOYWphMiA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG5hamEgJiYgbmFqYS5WRVJTSU9OICYmIG5hamEuVkVSU0lPTiA+PSAyIH07XG5cdHZhciBuYWphRXZlbnRQYXJhbXMgPSBmdW5jdGlvbiAocGFyYW1zKSB7IHJldHVybiBpc05hamEyKCkgPyBwYXJhbXMuZGV0YWlsIDogcGFyYW1zIH07XG5cdHZhciBuYWphUmVxdWVzdCA9IGZ1bmN0aW9uIChwYXJhbXMpIHsgcmV0dXJuIGlzTmFqYTIoKSA/IHBhcmFtcy5kZXRhaWwucmVxdWVzdCA6IHBhcmFtcy54aHIgfTtcblx0ZGF0YUdyaWRSZWdpc3RlckV4dGVuc2lvbiA9IGZ1bmN0aW9uIChuYW1lLCBleHRlbnNpb24pIHtcblx0XHR2YXIgaW5pdCA9IGV4dGVuc2lvbi5pbml0O1xuXHRcdHZhciBzdWNjZXNzID0gZXh0ZW5zaW9uLnN1Y2Nlc3M7XG5cdFx0dmFyIGJlZm9yZSA9IGV4dGVuc2lvbi5iZWZvcmU7XG5cdFx0dmFyIGNvbXBsZXRlID0gZXh0ZW5zaW9uLmNvbXBsZXRlO1xuXG5cblx0XHR2YXIgTmV3RXh0ZW5zaW9uID0gZnVuY3Rpb24gTmV3RXh0ZW5zaW9uKG5hamEsIG5hbWUpIHtcblx0XHRcdHRoaXMubmFtZSA9IG5hbWU7XG5cblx0XHRcdHRoaXMuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uIChuYWphKSB7XG5cdFx0XHRcdGlmKGluaXQpIHtcblx0XHRcdFx0XHRuYWphLmFkZEV2ZW50TGlzdGVuZXIoJ2luaXQnLCBmdW5jdGlvbiAocGFyYW1zKSAge1xuXHRcdFx0XHRcdFx0aW5pdChuYWphRXZlbnRQYXJhbXMocGFyYW1zKS5kZWZhdWx0T3B0aW9ucyk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRpZihzdWNjZXNzKSB7XG5cdFx0XHRcdFx0bmFqYS5hZGRFdmVudExpc3RlbmVyKCdzdWNjZXNzJywgZnVuY3Rpb24gKHBhcmFtcykgIHtcblx0XHRcdFx0XHRcdHZhciBwYXlsb2FkID0gaXNOYWphMigpID8gcGFyYW1zLmRldGFpbC5wYXlsb2FkIDogcGFyYW1zLnJlc3BvbnNlO1xuXHRcdFx0XHRcdFx0c3VjY2VzcyhwYXlsb2FkLCBuYWphRXZlbnRQYXJhbXMocGFyYW1zKS5vcHRpb25zKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKGJlZm9yZSkge1xuXHRcdFx0XHRcdG5hamEuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JlJywgZnVuY3Rpb24gKHBhcmFtcykge1xuXHRcdFx0XHRcdFx0YmVmb3JlKG5hamFSZXF1ZXN0KHBhcmFtcyksIG5hamFFdmVudFBhcmFtcyhwYXJhbXMpLm9wdGlvbnMpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYoY29tcGxldGUpIHtcblx0XHRcdFx0XHRuYWphLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbXBsZXRlJywgZnVuY3Rpb24gKHBhcmFtcykge1xuXHRcdFx0XHRcdFx0Y29tcGxldGUobmFqYVJlcXVlc3QocGFyYW1zKSwgbmFqYUV2ZW50UGFyYW1zKHBhcmFtcykub3B0aW9ucyk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICghaXNOYWphMigpKSB7XG5cdFx0XHRcdHRoaXMuaW5pdGlhbGl6ZShuYWphKTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB0aGlzO1xuXHRcdH1cblxuXHRcdGlmIChpc05hamEyKCkpIHtcblx0XHRcdG5hamEucmVnaXN0ZXJFeHRlbnNpb24obmV3IE5ld0V4dGVuc2lvbihudWxsLCBuYW1lKSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG5hamEucmVnaXN0ZXJFeHRlbnNpb24oTmV3RXh0ZW5zaW9uLCBuYW1lKTtcblx0XHR9XG5cdH07XG59IGVsc2UgaWYgKCQubmV0dGUpIHtcblx0XHRkYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uID0gZnVuY3Rpb24gKG5hbWUsIGV4dGVuc2lvbikge1xuXHRcdFx0JC5uZXR0ZS5leHQobmFtZSwgZXh0ZW5zaW9uKTtcblx0XHR9O1xufVxuXG5kYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCd1YmxhYm9vLXNwaW5uZXJzJywge1xuXHRiZWZvcmU6IGZ1bmN0aW9uKHhociwgc2V0dGluZ3MpIHtcblx0XHR2YXIgZWwsIGlkLCByb3dfZGV0YWlsLCBzcGlubmVyX3RlbXBsYXRlLCBncmlkX2Z1bGxuYW1lO1xuXHRcdGlmIChzZXR0aW5ncy5uZXR0ZSkge1xuXHRcdFx0ZWwgPSBzZXR0aW5ncy5uZXR0ZS5lbDtcblx0XHRcdHNwaW5uZXJfdGVtcGxhdGUgPSAkKCc8ZGl2IGNsYXNzPVwidWJsYWJvby1zcGlubmVyIHVibGFib28tc3Bpbm5lci1zbWFsbFwiPjxpPjwvaT48aT48L2k+PGk+PC9pPjxpPjwvaT48L2Rpdj4nKTtcblx0XHRcdGlmIChlbC5pcygnLmRhdGFncmlkIFtuYW1lPVwiZ3JvdXBfYWN0aW9uW3N1Ym1pdF1cIl0nKSkge1xuXHRcdFx0XHRyZXR1cm4gZWwuYWZ0ZXIoc3Bpbm5lcl90ZW1wbGF0ZSk7XG5cdFx0XHR9IGVsc2UgaWYgKGVsLmlzKCcuZGF0YWdyaWQgYScpICYmIGVsLmRhdGEoJ3RvZ2dsZS1kZXRhaWwnKSkge1xuXHRcdFx0XHRpZCA9IHNldHRpbmdzLm5ldHRlLmVsLmF0dHIoJ2RhdGEtdG9nZ2xlLWRldGFpbCcpO1xuXHRcdFx0XHRncmlkX2Z1bGxuYW1lID0gc2V0dGluZ3MubmV0dGUuZWwuYXR0cignZGF0YS10b2dnbGUtZGV0YWlsLWdyaWQtZnVsbG5hbWUnKTtcblx0XHRcdFx0cm93X2RldGFpbCA9ICQoJy5pdGVtLWRldGFpbC0nICsgZ3JpZF9mdWxsbmFtZSArICctaWQtJyArIGlkKTtcblx0XHRcdFx0aWYgKCFyb3dfZGV0YWlsLmhhc0NsYXNzKCdsb2FkZWQnKSkge1xuXHRcdFx0XHRcdHJldHVybiBlbC5hZGRDbGFzcygndWJsYWJvby1zcGlubmVyLWljb24nKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChlbC5pcygnLmRhdGFncmlkIC5jb2wtcGFnaW5hdGlvbiBhJykpIHtcblx0XHRcdFx0cmV0dXJuIGVsLmNsb3Nlc3QoJy5yb3ctZ3JpZC1ib3R0b20nKS5maW5kKCcuY29sLXBlci1wYWdlJykucHJlcGVuZChzcGlubmVyX3RlbXBsYXRlKTtcblx0XHRcdH0gZWxzZSBpZiAoZWwuaXMoJy5kYXRhZ3JpZCAuZGF0YWdyaWQtcGVyLXBhZ2Utc3VibWl0JykpIHtcblx0XHRcdFx0cmV0dXJuIGVsLmNsb3Nlc3QoJy5yb3ctZ3JpZC1ib3R0b20nKS5maW5kKCcuY29sLXBlci1wYWdlJykucHJlcGVuZChzcGlubmVyX3RlbXBsYXRlKTtcblx0XHRcdH0gZWxzZSBpZiAoZWwuaXMoJy5kYXRhZ3JpZCAucmVzZXQtZmlsdGVyJykpIHtcblx0XHRcdFx0cmV0dXJuIGVsLmNsb3Nlc3QoJy5yb3ctZ3JpZC1ib3R0b20nKS5maW5kKCcuY29sLXBlci1wYWdlJykucHJlcGVuZChzcGlubmVyX3RlbXBsYXRlKTtcblx0XHRcdH1cblx0XHR9XG5cdH0sXG5cdGNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHQkKCcudWJsYWJvby1zcGlubmVyJykucmVtb3ZlKCk7XG5cdFx0cmV0dXJuICQoJy51YmxhYm9vLXNwaW5uZXItaWNvbicpLnJlbW92ZUNsYXNzKCd1YmxhYm9vLXNwaW5uZXItaWNvbicpO1xuXHR9XG59KTtcbiIsInZhciBkYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uLCBkYXRhR3JpZFJlZ2lzdGVyQWpheENhbGwsIGRhdGFHcmlkTG9hZCwgZGF0YUdyaWRTdWJtaXRGb3JtO1xuXG5pZiAodHlwZW9mIG5hamEgIT09IFwidW5kZWZpbmVkXCIpIHtcblx0dmFyIGlzTmFqYTIgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBuYWphICYmIG5hamEuVkVSU0lPTiAmJiBuYWphLlZFUlNJT04gPj0gMiB9O1xuXHR2YXIgbmFqYUV2ZW50UGFyYW1zID0gZnVuY3Rpb24gKHBhcmFtcykgeyByZXR1cm4gaXNOYWphMigpID8gcGFyYW1zLmRldGFpbCA6IHBhcmFtcyB9O1xuXHR2YXIgbmFqYVJlcXVlc3QgPSBmdW5jdGlvbiAocGFyYW1zKSB7IHJldHVybiBpc05hamEyKCkgPyBwYXJhbXMuZGV0YWlsLnJlcXVlc3QgOiBwYXJhbXMueGhyIH07XG5cdGRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24gPSBmdW5jdGlvbiAobmFtZSwgZXh0ZW5zaW9uKSB7XG5cdFx0dmFyIGluaXQgPSBleHRlbnNpb24uaW5pdDtcblx0XHR2YXIgc3VjY2VzcyA9IGV4dGVuc2lvbi5zdWNjZXNzO1xuXHRcdHZhciBiZWZvcmUgPSBleHRlbnNpb24uYmVmb3JlO1xuXHRcdHZhciBjb21wbGV0ZSA9IGV4dGVuc2lvbi5jb21wbGV0ZTtcblx0XHR2YXIgaW50ZXJhY3Rpb24gPSBleHRlbnNpb24uaW50ZXJhY3Rpb247XG5cblxuXHRcdHZhciBOZXdFeHRlbnNpb24gPSBmdW5jdGlvbiBOZXdFeHRlbnNpb24obmFqYSwgbmFtZSkge1xuXHRcdFx0dGhpcy5uYW1lID0gbmFtZTtcblxuXHRcdFx0dGhpcy5pbml0aWFsaXplID0gZnVuY3Rpb24gKG5hamEpIHtcblx0XHRcdFx0aWYoaW5pdCkge1xuXHRcdFx0XHRcdG5hamEuYWRkRXZlbnRMaXN0ZW5lcignaW5pdCcsIGZ1bmN0aW9uIChwYXJhbXMpICB7XG5cdFx0XHRcdFx0XHRpbml0KG5hamFFdmVudFBhcmFtcyhwYXJhbXMpLmRlZmF1bHRPcHRpb25zKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKHN1Y2Nlc3MpIHtcblx0XHRcdFx0XHRuYWphLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBmdW5jdGlvbiAocGFyYW1zKSAge1xuXHRcdFx0XHRcdFx0dmFyIHBheWxvYWQgPSBpc05hamEyKCkgPyBwYXJhbXMuZGV0YWlsLnBheWxvYWQgOiBwYXJhbXMucmVzcG9uc2U7XG5cdFx0XHRcdFx0XHRzdWNjZXNzKHBheWxvYWQsIG5hamFFdmVudFBhcmFtcyhwYXJhbXMpLm9wdGlvbnMpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dmFyIGludGVyYWN0aW9uVGFyZ2V0ID0gbmFqYTtcblx0XHRcdFx0aWYgKGlzTmFqYTIoKSkge1xuXHRcdFx0XHRcdGludGVyYWN0aW9uVGFyZ2V0ID0gaW50ZXJhY3Rpb25UYXJnZXQudWlIYW5kbGVyO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0aW50ZXJhY3Rpb25UYXJnZXQuYWRkRXZlbnRMaXN0ZW5lcignaW50ZXJhY3Rpb24nLCBmdW5jdGlvbiAocGFyYW1zKSB7XG5cdFx0XHRcdFx0aWYgKGlzTmFqYTIoKSkge1xuXHRcdFx0XHRcdFx0cGFyYW1zLmRldGFpbC5vcHRpb25zLm5ldHRlID0ge1xuXHRcdFx0XHRcdFx0XHRlbDogJChwYXJhbXMuZGV0YWlsLmVsZW1lbnQpXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHBhcmFtcy5vcHRpb25zLm5ldHRlID0ge1xuXHRcdFx0XHRcdFx0XHRlbDogJChwYXJhbXMuZWxlbWVudClcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKGludGVyYWN0aW9uKSB7XG5cdFx0XHRcdFx0XHRpZiAoIWludGVyYWN0aW9uKG5hamFFdmVudFBhcmFtcyhwYXJhbXMpLm9wdGlvbnMpKXtcblx0XHRcdFx0XHRcdFx0cGFyYW1zLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHRpZihiZWZvcmUpIHtcblx0XHRcdFx0XHRuYWphLmFkZEV2ZW50TGlzdGVuZXIoJ2JlZm9yZScsIGZ1bmN0aW9uIChwYXJhbXMpIHtcblx0XHRcdFx0XHRcdGlmICghYmVmb3JlKG5hamFSZXF1ZXN0KHBhcmFtcyksIG5hamFFdmVudFBhcmFtcyhwYXJhbXMpLm9wdGlvbnMpKVxuXHRcdFx0XHRcdFx0XHRwYXJhbXMucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmKGNvbXBsZXRlKSB7XG5cdFx0XHRcdFx0bmFqYS5hZGRFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIGZ1bmN0aW9uIChwYXJhbXMpIHtcblx0XHRcdFx0XHRcdGNvbXBsZXRlKG5hamFSZXF1ZXN0KHBhcmFtcyksIG5hamFFdmVudFBhcmFtcyhwYXJhbXMpLm9wdGlvbnMpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoIWlzTmFqYTIoKSkge1xuXHRcdFx0XHR0aGlzLmluaXRpYWxpemUobmFqYSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdGhpcztcblx0XHR9XG5cblx0XHRpZiAoaXNOYWphMigpKSB7XG5cdFx0XHRuYWphLnJlZ2lzdGVyRXh0ZW5zaW9uKG5ldyBOZXdFeHRlbnNpb24obnVsbCwgbmFtZSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuYWphLnJlZ2lzdGVyRXh0ZW5zaW9uKE5ld0V4dGVuc2lvbiwgbmFtZSk7XG5cdFx0fVxuXHR9O1xuXG5cblx0ZGF0YUdyaWRSZWdpc3RlckFqYXhDYWxsID0gZnVuY3Rpb24gKHBhcmFtcykge1xuICAgICAgICB2YXIgbWV0aG9kID0gcGFyYW1zLnR5cGUgfHwgJ0dFVCc7XG4gICAgICAgIHZhciBkYXRhID0gcGFyYW1zLmRhdGEgfHwgbnVsbDtcblxuXHRcdG5hamEubWFrZVJlcXVlc3QobWV0aG9kLCBwYXJhbXMudXJsLCBkYXRhLCB7fSlcblx0XHRcdC50aGVuKHBhcmFtcy5zdWNjZXNzKVxuXHRcdFx0LmNhdGNoKHBhcmFtcy5lcnJvcik7XG5cdH07XG5cblx0ZGF0YUdyaWRMb2FkID0gZnVuY3Rpb24gKCkge1xuXHRcdG5hamEubG9hZCgpO1xuXHR9O1xuXG5cdGRhdGFHcmlkU3VibWl0Rm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XG5cdFx0cmV0dXJuIG5hamEudWlIYW5kbGVyLnN1Ym1pdEZvcm0oZm9ybS5nZXQoMCkpO1xuXHR9O1xufSBlbHNlIGlmICgkLm5ldHRlKSB7XG5cdGRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24gPSBmdW5jdGlvbiAobmFtZSwgZXh0ZW5zaW9uKSB7XG5cdFx0JC5uZXR0ZS5leHQobmFtZSwgZXh0ZW5zaW9uKTtcblx0fTtcblx0ZGF0YUdyaWRSZWdpc3RlckFqYXhDYWxsID0gZnVuY3Rpb24gKHBhcmFtcykge1xuXHRcdCQubmV0dGUuYWpheChwYXJhbXMpO1xuXHR9O1xuXHRkYXRhR3JpZExvYWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0JC5uZXR0ZS5sb2FkKCk7XG5cdH07XG5cdGRhdGFHcmlkU3VibWl0Rm9ybSA9IGZ1bmN0aW9uIChmb3JtKSB7XG5cdFx0cmV0dXJuIGZvcm0uc3VibWl0KCk7XG5cdH07XG59IGVsc2Uge1xuXHR0aHJvdyBuZXcgRXJyb3IoXCJJbmNsdWRlIE5hamEuanMgb3IgbmV0dGUuYWpheCBmb3IgZGF0YWdyaWRzIHRvIHdvcmshXCIpXG59XG5cblxudmFyIGRhdGFncmlkRml0bGVyTXVsdGlTZWxlY3QsIGRhdGFncmlkR3JvdXBBY3Rpb25NdWx0aVNlbGVjdCwgZGF0YWdyaWRTaGlmdEdyb3VwU2VsZWN0aW9uLCBkYXRhZ3JpZFNvcnRhYmxlLCBkYXRhZ3JpZFNvcnRhYmxlVHJlZSwgZ2V0RXZlbnREb21QYXRoLFxuXHRpbmRleE9mID0gW10uaW5kZXhPZiB8fCBmdW5jdGlvbihpdGVtKSB7IGZvciAodmFyIGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsgaWYgKGkgaW4gdGhpcyAmJiB0aGlzW2ldID09PSBpdGVtKSByZXR1cm4gaTsgfSByZXR1cm4gLTE7IH07XG5cbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1kYXRhZ3JpZC1jb25maXJtXTpub3QoLmFqYXgpJywgZnVuY3Rpb24oZSkge1xuXHRpZiAoIWNvbmZpcm0oJChlLnRhcmdldCkuY2xvc2VzdCgnYScpLmF0dHIoJ2RhdGEtZGF0YWdyaWQtY29uZmlybScpKSkge1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0cmV0dXJuIGUucHJldmVudERlZmF1bHQoKTtcblx0fVxufSk7XG5cbmlmICh0eXBlb2YgbmFqYSAhPT0gXCJ1bmRlZmluZWRcIikge1xuXHRkYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCdkYXRhZ3JpZC5jb25maXJtJywge1xuXHRcdGludGVyYWN0aW9uOiBmdW5jdGlvbihzZXR0aW5ncykge1xuXHRcdFx0dmFyIGNvbmZpcm1fbWVzc2FnZTtcblx0XHRcdGlmIChzZXR0aW5ncy5uZXR0ZSkge1xuXHRcdFx0XHRjb25maXJtX21lc3NhZ2UgPSBzZXR0aW5ncy5uZXR0ZS5lbC5kYXRhKCdkYXRhZ3JpZC1jb25maXJtJyk7XG5cdFx0XHRcdGlmIChjb25maXJtX21lc3NhZ2UpIHtcblx0XHRcdFx0XHRyZXR1cm4gY29uZmlybShjb25maXJtX21lc3NhZ2UpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH0pO1xufSBlbHNlIHtcblx0ZGF0YUdyaWRSZWdpc3RlckV4dGVuc2lvbignZGF0YWdyaWQuY29uZmlybScsIHtcblx0XHRiZWZvcmU6IGZ1bmN0aW9uKHhociwgc2V0dGluZ3MpIHtcblx0XHRcdHZhciBjb25maXJtX21lc3NhZ2U7XG5cdFx0XHRpZiAoc2V0dGluZ3MubmV0dGUpIHtcblx0XHRcdFx0Y29uZmlybV9tZXNzYWdlID0gc2V0dGluZ3MubmV0dGUuZWwuZGF0YSgnZGF0YWdyaWQtY29uZmlybScpO1xuXHRcdFx0XHRpZiAoY29uZmlybV9tZXNzYWdlKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbmZpcm0oY29uZmlybV9tZXNzYWdlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHR9KTtcbn1cblxuXG4kKGRvY3VtZW50KS5vbignY2hhbmdlJywgJ3NlbGVjdFtkYXRhLWF1dG9zdWJtaXQtcGVyLXBhZ2VdJywgZnVuY3Rpb24oKSB7XG5cdHZhciBidXR0b247XG5cdGJ1dHRvbiA9ICQodGhpcykucGFyZW50KCkuZmluZCgnaW5wdXRbdHlwZT1zdWJtaXRdJyk7XG5cdGlmIChidXR0b24ubGVuZ3RoID09PSAwKSB7XG5cdFx0YnV0dG9uID0gJCh0aGlzKS5wYXJlbnQoKS5maW5kKCdidXR0b25bdHlwZT1zdWJtaXRdJyk7XG5cdH1cblx0cmV0dXJuIGJ1dHRvbi5jbGljaygpO1xufSkub24oJ2NoYW5nZScsICdzZWxlY3RbZGF0YS1hdXRvc3VibWl0XScsIGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gZGF0YUdyaWRTdWJtaXRGb3JtKCQodGhpcykuY2xvc2VzdCgnZm9ybScpLmZpcnN0KCkpO1xufSkub24oJ2NoYW5nZScsICdpbnB1dFtkYXRhLWF1dG9zdWJtaXRdW2RhdGEtYXV0b3N1Ym1pdC1jaGFuZ2VdJywgZnVuY3Rpb24oZSkge1xuXHR2YXIgJHRoaXMsIGNvZGU7XG5cdGNvZGUgPSBlLndoaWNoIHx8IGUua2V5Q29kZSB8fCAwO1xuXHRjbGVhclRpbWVvdXQod2luZG93LmRhdGFncmlkX2F1dG9zdWJtaXRfdGltZXIpO1xuXHQkdGhpcyA9ICQodGhpcyk7XG5cdHJldHVybiB3aW5kb3cuZGF0YWdyaWRfYXV0b3N1Ym1pdF90aW1lciA9IHNldFRpbWVvdXQoKGZ1bmN0aW9uKF90aGlzKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIGRhdGFHcmlkU3VibWl0Rm9ybSgkdGhpcy5jbG9zZXN0KCdmb3JtJykuZmlyc3QoKSk7XG5cdFx0fTtcblx0fSkodGhpcyksIDIwMCk7XG59KS5vbigna2V5dXAnLCAnaW5wdXRbZGF0YS1hdXRvc3VibWl0XScsIGZ1bmN0aW9uKGUpIHtcblx0dmFyICR0aGlzLCBjb2RlO1xuXHRjb2RlID0gZS53aGljaCB8fCBlLmtleUNvZGUgfHwgMDtcblx0aWYgKChjb2RlICE9PSAxMykgJiYgKChjb2RlID49IDkgJiYgY29kZSA8PSA0MCkgfHwgKGNvZGUgPj0gMTEyICYmIGNvZGUgPD0gMTIzKSkpIHtcblx0XHRyZXR1cm47XG5cdH1cblx0Y2xlYXJUaW1lb3V0KHdpbmRvdy5kYXRhZ3JpZF9hdXRvc3VibWl0X3RpbWVyKTtcblx0JHRoaXMgPSAkKHRoaXMpO1xuXHRyZXR1cm4gd2luZG93LmRhdGFncmlkX2F1dG9zdWJtaXRfdGltZXIgPSBzZXRUaW1lb3V0KChmdW5jdGlvbihfdGhpcykge1xuXHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiBkYXRhR3JpZFN1Ym1pdEZvcm0oJHRoaXMuY2xvc2VzdCgnZm9ybScpLmZpcnN0KCkpO1xuXHRcdH07XG5cdH0pKHRoaXMpLCAyMDApO1xufSkub24oJ2tleWRvd24nLCAnLmRhdGFncmlkLWlubGluZS1lZGl0IGlucHV0JywgZnVuY3Rpb24oZSkge1xuXHR2YXIgY29kZTtcblx0Y29kZSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlIHx8IDA7XG5cdGlmIChjb2RlID09PSAxMykge1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHJldHVybiAkKHRoaXMpLmNsb3Nlc3QoJ3RyJykuZmluZCgnLmNvbC1hY3Rpb24taW5saW5lLWVkaXQgW25hbWU9XCJpbmxpbmVfZWRpdFtzdWJtaXRdXCJdJykuY2xpY2soKTtcblx0fVxufSk7XG5cbiQoZG9jdW1lbnQpLm9uKCdrZXlkb3duJywgJ2lucHV0W2RhdGEtZGF0YWdyaWQtbWFudWFsc3VibWl0XScsIGZ1bmN0aW9uKGUpIHtcblx0dmFyIGNvZGU7XG5cdGNvZGUgPSBlLndoaWNoIHx8IGUua2V5Q29kZSB8fCAwO1xuXHRpZiAoY29kZSA9PT0gMTMpIHtcblx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRyZXR1cm4gZGF0YUdyaWRTdWJtaXRGb3JtKCQodGhpcykuY2xvc2VzdCgnZm9ybScpLmZpcnN0KCkpO1xuXHR9XG59KTtcblxuZ2V0RXZlbnREb21QYXRoID0gZnVuY3Rpb24oZSkge1xuXHR2YXIgbm9kZSwgcGF0aDtcblx0aWYgKGluZGV4T2YuY2FsbChlLCBwYXRoKSA+PSAwKSB7XG5cdFx0cmV0dXJuIGUucGF0aDtcblx0fVxuXHRwYXRoID0gW107XG5cdG5vZGUgPSBlLnRhcmdldDtcblx0d2hpbGUgKG5vZGUgIT09IGRvY3VtZW50LmJvZHkpIHtcblx0XHRpZiAobm9kZSA9PT0gbnVsbCkge1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdHBhdGgucHVzaChub2RlKTtcblx0XHRub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuXHR9XG5cdHJldHVybiBwYXRoO1xufTtcblxuZGF0YWdyaWRTaGlmdEdyb3VwU2VsZWN0aW9uID0gZnVuY3Rpb24oKSB7XG5cdHZhciBsYXN0X2NoZWNrYm94O1xuXHRsYXN0X2NoZWNrYm94ID0gbnVsbDtcblx0cmV0dXJuIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdHZhciBjaGVja2JveGVzX3Jvd3MsIGN1cnJlbnRfY2hlY2tib3hfcm93LCBlbCwgZXZlbnQsIGksIGllLCBpbnB1dCwgaiwgaywgbGFzdF9jaGVja2JveF9yb3csIGxhc3RfY2hlY2tib3hfdGJvZHksIGxlbiwgbGVuMSwgbGVuMiwgcmVmLCByZWYxLCByZXN1bHRzLCByb3csIHJvd3M7XG5cdFx0cmVmID0gZ2V0RXZlbnREb21QYXRoKGUpO1xuXHRcdGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0ZWwgPSByZWZbaV07XG5cdFx0XHRpZiAoJChlbCkuaXMoJy5jb2wtY2hlY2tib3gnKSAmJiBsYXN0X2NoZWNrYm94ICYmIGUuc2hpZnRLZXkpIHtcblx0XHRcdFx0Y3VycmVudF9jaGVja2JveF9yb3cgPSAkKGVsKS5jbG9zZXN0KCd0cicpO1xuXHRcdFx0XHRsYXN0X2NoZWNrYm94X3JvdyA9IGxhc3RfY2hlY2tib3guY2xvc2VzdCgndHInKTtcblx0XHRcdFx0bGFzdF9jaGVja2JveF90Ym9keSA9IGxhc3RfY2hlY2tib3hfcm93LmNsb3Nlc3QoJ3Rib2R5Jyk7XG5cdFx0XHRcdGNoZWNrYm94ZXNfcm93cyA9IGxhc3RfY2hlY2tib3hfdGJvZHkuZmluZCgndHInKS50b0FycmF5KCk7XG5cdFx0XHRcdGlmIChjdXJyZW50X2NoZWNrYm94X3Jvdy5pbmRleCgpID4gbGFzdF9jaGVja2JveF9yb3cuaW5kZXgoKSkge1xuXHRcdFx0XHRcdHJvd3MgPSBjaGVja2JveGVzX3Jvd3Muc2xpY2UobGFzdF9jaGVja2JveF9yb3cuaW5kZXgoKSwgY3VycmVudF9jaGVja2JveF9yb3cuaW5kZXgoKSk7XG5cdFx0XHRcdH0gZWxzZSBpZiAoY3VycmVudF9jaGVja2JveF9yb3cuaW5kZXgoKSA8IGxhc3RfY2hlY2tib3hfcm93LmluZGV4KCkpIHtcblx0XHRcdFx0XHRyb3dzID0gY2hlY2tib3hlc19yb3dzLnNsaWNlKGN1cnJlbnRfY2hlY2tib3hfcm93LmluZGV4KCkgKyAxLCBsYXN0X2NoZWNrYm94X3Jvdy5pbmRleCgpKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIXJvd3MpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdFx0Zm9yIChqID0gMCwgbGVuMSA9IHJvd3MubGVuZ3RoOyBqIDwgbGVuMTsgaisrKSB7XG5cdFx0XHRcdFx0cm93ID0gcm93c1tqXTtcblx0XHRcdFx0XHRpbnB1dCA9ICQocm93KS5maW5kKCcuY29sLWNoZWNrYm94IGlucHV0W3R5cGU9Y2hlY2tib3hdJylbMF07XG5cdFx0XHRcdFx0aWYgKGlucHV0KSB7XG5cdFx0XHRcdFx0XHRpbnB1dC5jaGVja2VkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdGllID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZihcIk1TSUUgXCIpO1xuXHRcdFx0XHRcdFx0aWYgKGllKSB7XG5cdFx0XHRcdFx0XHRcdGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG5cdFx0XHRcdFx0XHRcdGV2ZW50LmluaXRFdmVudCgnY2hhbmdlJywgdHJ1ZSwgdHJ1ZSk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRldmVudCA9IG5ldyBFdmVudCgnY2hhbmdlJywge1xuXHRcdFx0XHRcdFx0XHRcdCdidWJibGVzJzogdHJ1ZVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlucHV0LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZWYxID0gZ2V0RXZlbnREb21QYXRoKGUpO1xuXHRcdHJlc3VsdHMgPSBbXTtcblx0XHRmb3IgKGsgPSAwLCBsZW4yID0gcmVmMS5sZW5ndGg7IGsgPCBsZW4yOyBrKyspIHtcblx0XHRcdGVsID0gcmVmMVtrXTtcblx0XHRcdGlmICgkKGVsKS5pcygnLmNvbC1jaGVja2JveCcpKSB7XG5cdFx0XHRcdHJlc3VsdHMucHVzaChsYXN0X2NoZWNrYm94ID0gJChlbCkpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzdWx0cy5wdXNoKHZvaWQgMCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHRzO1xuXHR9KTtcbn07XG5cbmRhdGFncmlkU2hpZnRHcm91cFNlbGVjdGlvbigpO1xuXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbihlKSB7XG5cdHZhciBidXR0b25zLCBjaGVja2VkX2lucHV0cywgY291bnRlciwgZXZlbnQsIGdyaWQsIGksIGllLCBpbnB1dCwgaW5wdXRzLCBsZW4sIHJlc3VsdHMsIHNlbGVjdCwgdG90YWw7XG5cdGdyaWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY2hlY2snKTtcblx0aWYgKGdyaWQpIHtcblx0XHRjaGVja2VkX2lucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2RhdGEtY2hlY2stYWxsLScgKyBncmlkICsgJ106Y2hlY2tlZCcpO1xuXHRcdHNlbGVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kYXRhZ3JpZC0nICsgZ3JpZCArICcgc2VsZWN0W25hbWU9XCJncm91cF9hY3Rpb25bZ3JvdXBfYWN0aW9uXVwiXScpO1xuXHRcdGJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGF0YWdyaWQtJyArIGdyaWQgKyAnIGlucHV0W3R5cGU9XCJzdWJtaXRcIl0nKTtcblx0XHRpZiAoYnV0dG9ucy5sZW5ndGggPT09IDApIHtcblx0XHRcdGJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGF0YWdyaWQtJyArIGdyaWQgKyAnIGJ1dHRvblt0eXBlPVwic3VibWl0XCJdJyk7XG5cdFx0fVxuXHRcdGNvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGF0YWdyaWQtJyArIGdyaWQgKyAnIC5kYXRhZ3JpZC1zZWxlY3RlZC1yb3dzLWNvdW50Jyk7XG5cblx0XHRpZiAoY2hlY2tlZF9pbnB1dHMubGVuZ3RoKSB7XG5cdFx0XHRpZiAoYnV0dG9ucykge1xuXHRcdFx0XHRidXR0b25zLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xuXHRcdFx0XHRcdGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHRcdGlmIChzZWxlY3QpIHtcblx0XHRcdFx0c2VsZWN0LmRpc2FibGVkID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHR0b3RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W2RhdGEtY2hlY2stYWxsLScgKyBncmlkICsgJ10nKS5sZW5ndGg7XG5cdFx0XHRpZiAoY291bnRlcikge1xuXHRcdFx0XHRjb3VudGVyLmlubmVySFRNTCA9IGNoZWNrZWRfaW5wdXRzLmxlbmd0aCArICcvJyArIHRvdGFsO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRpZiAoYnV0dG9ucykge1xuXHRcdFx0XHRidXR0b25zLmZvckVhY2goZnVuY3Rpb24gKGJ1dHRvbikge1xuXHRcdFx0XHRcdGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHNlbGVjdCkge1xuXHRcdFx0XHRzZWxlY3QuZGlzYWJsZWQgPSB0cnVlO1xuXHRcdFx0XHRzZWxlY3QudmFsdWUgPSBcIlwiO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGNvdW50ZXIpIHtcblx0XHRcdFx0Y291bnRlci5pbm5lckhUTUwgPSBcIlwiO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZSA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFIFwiKTtcblx0XHRpZiAoaWUpIHtcblx0XHRcdGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG5cdFx0XHRldmVudC5pbml0RXZlbnQoJ2NoYW5nZScsIHRydWUsIHRydWUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRldmVudCA9IG5ldyBFdmVudCgnY2hhbmdlJywge1xuXHRcdFx0XHQnYnViYmxlcyc6IHRydWVcblx0XHRcdH0pO1xuXHRcdH1cblx0XHRpZiAoc2VsZWN0KSB7XG5cdFx0XHRzZWxlY3QuZGlzcGF0Y2hFdmVudChldmVudCk7XG5cdFx0fVxuXHR9XG5cdGdyaWQgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtY2hlY2stYWxsJyk7XG5cdGlmIChncmlkKSB7XG5cdFx0aW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXRbdHlwZT1jaGVja2JveF1bZGF0YS1jaGVjay1hbGwtJyArIGdyaWQgKyAnXScpO1xuXHRcdHJlc3VsdHMgPSBbXTtcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBpbnB1dHMubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcblx0XHRcdGlucHV0ID0gaW5wdXRzW2ldO1xuXHRcdFx0aW5wdXQuY2hlY2tlZCA9IGUudGFyZ2V0LmNoZWNrZWQ7XG5cdFx0XHRpZSA9IHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoXCJNU0lFIFwiKTtcblx0XHRcdGlmIChpZSkge1xuXHRcdFx0XHRldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xuXHRcdFx0XHRldmVudC5pbml0RXZlbnQoJ2NoYW5nZScsIHRydWUsIHRydWUpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0ZXZlbnQgPSBuZXcgRXZlbnQoJ2NoYW5nZScsIHtcblx0XHRcdFx0XHQnYnViYmxlcyc6IHRydWVcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0XHRyZXN1bHRzLnB1c2goaW5wdXQuZGlzcGF0Y2hFdmVudChldmVudCkpO1xuXHRcdH1cblx0XHRyZXR1cm4gcmVzdWx0cztcblx0fVxufSk7XG5cblxud2luZG93LmRhdGFncmlkU2VyaWFsaXplVXJsID0gZnVuY3Rpb24ob2JqLCBwcmVmaXgpIHtcbnZhciBzdHIgPSBbXTtcbmZvcih2YXIgcCBpbiBvYmopIHtcblx0aWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwKSkge1xuXHRcdHZhciBrID0gcHJlZml4ID8gcHJlZml4ICsgXCJbXCIgKyBwICsgXCJdXCIgOiBwLCB2ID0gb2JqW3BdO1xuXHRcdGlmICh2ICE9PSBudWxsICYmIHYgIT09IFwiXCIpIHtcblx0XHRcdGlmICh0eXBlb2YgdiA9PSBcIm9iamVjdFwiKSB7XG5cdFx0XHRcdHZhciByID0gd2luZG93LmRhdGFncmlkU2VyaWFsaXplVXJsKHYsIGspO1xuXHRcdFx0XHRcdGlmIChyKSB7XG5cdFx0XHRcdFx0XHRzdHIucHVzaChyKTtcblx0XHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzdHIucHVzaChlbmNvZGVVUklDb21wb25lbnQoaykgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudCh2KSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5yZXR1cm4gc3RyLmpvaW4oXCImXCIpO1xufVxuO1xuXG5kYXRhZ3JpZFNvcnRhYmxlID0gZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgJC5mbi5zb3J0YWJsZSA9PT0gJ3VuZGVmaW5lZCcpIHtcblx0XHRyZXR1cm47XG5cdH1cblx0cmV0dXJuICQoJy5kYXRhZ3JpZCBbZGF0YS1zb3J0YWJsZV0nKS5zb3J0YWJsZSh7XG5cdFx0aGFuZGxlOiAnLmhhbmRsZS1zb3J0Jyxcblx0XHRpdGVtczogJ3RyJyxcblx0XHRheGlzOiAneScsXG5cdFx0dXBkYXRlOiBmdW5jdGlvbihldmVudCwgdWkpIHtcblx0XHRcdHZhciBjb21wb25lbnRfcHJlZml4LCBkYXRhLCBpdGVtX2lkLCBuZXh0X2lkLCBwcmV2X2lkLCByb3csIHVybDtcblx0XHRcdHJvdyA9IHVpLml0ZW0uY2xvc2VzdCgndHJbZGF0YS1pZF0nKTtcblx0XHRcdGl0ZW1faWQgPSByb3cuZGF0YSgnaWQnKTtcblx0XHRcdHByZXZfaWQgPSBudWxsO1xuXHRcdFx0bmV4dF9pZCA9IG51bGw7XG5cdFx0XHRpZiAocm93LnByZXYoKS5sZW5ndGgpIHtcblx0XHRcdFx0cHJldl9pZCA9IHJvdy5wcmV2KCkuZGF0YSgnaWQnKTtcblx0XHRcdH1cblx0XHRcdGlmIChyb3cubmV4dCgpLmxlbmd0aCkge1xuXHRcdFx0XHRuZXh0X2lkID0gcm93Lm5leHQoKS5kYXRhKCdpZCcpO1xuXHRcdFx0fVxuXHRcdFx0dXJsID0gJCh0aGlzKS5kYXRhKCdzb3J0YWJsZS11cmwnKTtcblx0XHRcdGRhdGEgPSB7fTtcblx0XHRcdGNvbXBvbmVudF9wcmVmaXggPSByb3cuY2xvc2VzdCgnLmRhdGFncmlkJykuZmluZCgndGJvZHknKS5hdHRyKCdkYXRhLXNvcnRhYmxlLXBhcmVudC1wYXRoJyk7XG5cdFx0XHRkYXRhWyhjb21wb25lbnRfcHJlZml4ICsgJy1pdGVtX2lkJykucmVwbGFjZSgvXi0vLCAnJyldID0gaXRlbV9pZDtcblx0XHRcdGlmIChwcmV2X2lkICE9PSBudWxsKSB7XG5cdFx0XHRcdGRhdGFbKGNvbXBvbmVudF9wcmVmaXggKyAnLXByZXZfaWQnKS5yZXBsYWNlKC9eLS8sICcnKV0gPSBwcmV2X2lkO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG5leHRfaWQgIT09IG51bGwpIHtcblx0XHRcdFx0ZGF0YVsoY29tcG9uZW50X3ByZWZpeCArICctbmV4dF9pZCcpLnJlcGxhY2UoL14tLywgJycpXSA9IG5leHRfaWQ7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZGF0YUdyaWRSZWdpc3RlckFqYXhDYWxsKHtcblx0XHRcdFx0dHlwZTogJ0dFVCcsXG5cdFx0XHRcdHVybDogdXJsLFxuXHRcdFx0XHRkYXRhOiBkYXRhLFxuXHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGFsZXJ0KGpxWEhSLnN0YXR1c1RleHQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHR9LFxuXHRcdGhlbHBlcjogZnVuY3Rpb24oZSwgdWkpIHtcblx0XHRcdHVpLmNoaWxkcmVuKCkuZWFjaChmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuICQodGhpcykud2lkdGgoJCh0aGlzKS53aWR0aCgpKTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuIHVpO1xuXHRcdH1cblx0fSk7XG59O1xuXG4kKGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gZGF0YWdyaWRTb3J0YWJsZSgpO1xufSk7XG5cbmlmICh0eXBlb2YgZGF0YWdyaWRTb3J0YWJsZVRyZWUgPT09ICd1bmRlZmluZWQnKSB7XG5cdGRhdGFncmlkU29ydGFibGVUcmVlID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHR5cGVvZiAkKCcuZGF0YWdyaWQtdHJlZS1pdGVtLWNoaWxkcmVuJykuc29ydGFibGUgPT09ICd1bmRlZmluZWQnKSB7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHJldHVybiAkKCcuZGF0YWdyaWQtdHJlZS1pdGVtLWNoaWxkcmVuJykuc29ydGFibGUoe1xuXHRcdFx0aGFuZGxlOiAnLmhhbmRsZS1zb3J0Jyxcblx0XHRcdGl0ZW1zOiAnLmRhdGFncmlkLXRyZWUtaXRlbTpub3QoLmRhdGFncmlkLXRyZWUtaGVhZGVyKScsXG5cdFx0XHR0b2xlcmFuY2VFbGVtZW50OiAnPiAuZGF0YWdyaWQtdHJlZS1pdGVtLWNvbnRlbnQnLFxuXHRcdFx0Y29ubmVjdFdpdGg6ICcuZGF0YWdyaWQtdHJlZS1pdGVtLWNoaWxkcmVuJyxcblx0XHRcdHVwZGF0ZTogZnVuY3Rpb24oZXZlbnQsIHVpKSB7XG5cdFx0XHRcdHZhciBjb21wb25lbnRfcHJlZml4LCBkYXRhLCBpdGVtX2lkLCBuZXh0X2lkLCBwYXJlbnQsIHBhcmVudF9pZCwgcHJldl9pZCwgcm93LCB1cmw7XG5cdFx0XHRcdCQoJy50b2dnbGUtdHJlZS10by1kZWxldGUnKS5yZW1vdmUoKTtcblx0XHRcdFx0cm93ID0gdWkuaXRlbS5jbG9zZXN0KCcuZGF0YWdyaWQtdHJlZS1pdGVtW2RhdGEtaWRdJyk7XG5cdFx0XHRcdGl0ZW1faWQgPSByb3cuZGF0YSgnaWQnKTtcblx0XHRcdFx0cHJldl9pZCA9IG51bGw7XG5cdFx0XHRcdG5leHRfaWQgPSBudWxsO1xuXHRcdFx0XHRwYXJlbnRfaWQgPSBudWxsO1xuXHRcdFx0XHRpZiAocm93LnByZXYoKS5sZW5ndGgpIHtcblx0XHRcdFx0XHRwcmV2X2lkID0gcm93LnByZXYoKS5kYXRhKCdpZCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChyb3cubmV4dCgpLmxlbmd0aCkge1xuXHRcdFx0XHRcdG5leHRfaWQgPSByb3cubmV4dCgpLmRhdGEoJ2lkJyk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cGFyZW50ID0gcm93LnBhcmVudCgpLmNsb3Nlc3QoJy5kYXRhZ3JpZC10cmVlLWl0ZW0nKTtcblx0XHRcdFx0aWYgKHBhcmVudC5sZW5ndGgpIHtcblx0XHRcdFx0XHRwYXJlbnQuZmluZCgnLmRhdGFncmlkLXRyZWUtaXRlbS1jaGlsZHJlbicpLmZpcnN0KCkuY3NzKHtcblx0XHRcdFx0XHRcdGRpc3BsYXk6ICdibG9jaydcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRwYXJlbnQuYWRkQ2xhc3MoJ2hhcy1jaGlsZHJlbicpO1xuXHRcdFx0XHRcdHBhcmVudF9pZCA9IHBhcmVudC5kYXRhKCdpZCcpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHVybCA9ICQodGhpcykuZGF0YSgnc29ydGFibGUtdXJsJyk7XG5cdFx0XHRcdGlmICghdXJsKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHBhcmVudC5maW5kKCdbZGF0YS10b2dnbGUtdHJlZV0nKS5maXJzdCgpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblx0XHRcdFx0Y29tcG9uZW50X3ByZWZpeCA9IHJvdy5jbG9zZXN0KCcuZGF0YWdyaWQtdHJlZScpLmF0dHIoJ2RhdGEtc29ydGFibGUtcGFyZW50LXBhdGgnKTtcblx0XHRcdFx0ZGF0YSA9IHt9O1xuXHRcdFx0XHRkYXRhWyhjb21wb25lbnRfcHJlZml4ICsgJy1pdGVtX2lkJykucmVwbGFjZSgvXi0vLCAnJyldID0gaXRlbV9pZDtcblx0XHRcdFx0aWYgKHByZXZfaWQgIT09IG51bGwpIHtcblx0XHRcdFx0XHRkYXRhWyhjb21wb25lbnRfcHJlZml4ICsgJy1wcmV2X2lkJykucmVwbGFjZSgvXi0vLCAnJyldID0gcHJldl9pZDtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAobmV4dF9pZCAhPT0gbnVsbCkge1xuXHRcdFx0XHRcdGRhdGFbKGNvbXBvbmVudF9wcmVmaXggKyAnLW5leHRfaWQnKS5yZXBsYWNlKC9eLS8sICcnKV0gPSBuZXh0X2lkO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGRhdGFbKGNvbXBvbmVudF9wcmVmaXggKyAnLXBhcmVudF9pZCcpLnJlcGxhY2UoL14tLywgJycpXSA9IHBhcmVudF9pZDtcblx0XHRcdFx0cmV0dXJuIGRhdGFHcmlkUmVnaXN0ZXJBamF4Q2FsbCh7XG5cdFx0XHRcdFx0dHlwZTogJ0dFVCcsXG5cdFx0XHRcdFx0dXJsOiB1cmwsXG5cdFx0XHRcdFx0ZGF0YTogZGF0YSxcblx0XHRcdFx0XHRlcnJvcjogZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XG5cdFx0XHRcdFx0XHRpZiAoZXJyb3JUaHJvd24gIT09ICdhYm9ydCcpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGFsZXJ0KGpxWEhSLnN0YXR1c1RleHQpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHR9LFxuXHRcdFx0c3RvcDogZnVuY3Rpb24oZXZlbnQsIHVpKSB7XG5cdFx0XHRcdHJldHVybiAkKCcudG9nZ2xlLXRyZWUtdG8tZGVsZXRlJykucmVtb3ZlQ2xhc3MoJ3RvZ2dsZS10cmVlLXRvLWRlbGV0ZScpO1xuXHRcdFx0fSxcblx0XHRcdHN0YXJ0OiBmdW5jdGlvbihldmVudCwgdWkpIHtcblx0XHRcdFx0dmFyIHBhcmVudDtcblx0XHRcdFx0cGFyZW50ID0gdWkuaXRlbS5wYXJlbnQoKS5jbG9zZXN0KCcuZGF0YWdyaWQtdHJlZS1pdGVtJyk7XG5cdFx0XHRcdGlmIChwYXJlbnQubGVuZ3RoKSB7XG5cdFx0XHRcdFx0aWYgKHBhcmVudC5maW5kKCcuZGF0YWdyaWQtdHJlZS1pdGVtJykubGVuZ3RoID09PSAyKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcGFyZW50LmZpbmQoJ1tkYXRhLXRvZ2dsZS10cmVlXScpLmFkZENsYXNzKCd0b2dnbGUtdHJlZS10by1kZWxldGUnKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fTtcbn1cblxuJChmdW5jdGlvbigpIHtcblx0cmV0dXJuIGRhdGFncmlkU29ydGFibGVUcmVlKCk7XG59KTtcblxuZGF0YUdyaWRSZWdpc3RlckV4dGVuc2lvbignZGF0YWdyaWQuaGFwcHknLCB7XG5cdHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBjLCBjaGVja2VkX3Jvd3MsIGNsYXNzX3NlbGVjdG9yLCBjbGFzc2VzLCBldmVudCwgZ3JpZCwgZ3JpZHMsIGksIGllLCBpbnB1dCwgaiwgbGVuLCBsZW4xLCByZXN1bHRzO1xuXHRcdGlmICh3aW5kb3cuaGFwcHkpIHtcblx0XHRcdHdpbmRvdy5oYXBweS5yZXNldCgpO1xuXHRcdH1cblx0XHRncmlkcyA9ICQoJy5kYXRhZ3JpZCcpO1xuXHRcdHJlc3VsdHMgPSBbXTtcblx0XHRmb3IgKGkgPSAwLCBsZW4gPSBncmlkcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0Z3JpZCA9IGdyaWRzW2ldO1xuXHRcdFx0Y2xhc3NlcyA9IGdyaWQuY2xhc3NMaXN0O1xuXHRcdFx0Y2xhc3Nfc2VsZWN0b3IgPSAnJztcblx0XHRcdGZvciAoaiA9IDAsIGxlbjEgPSBjbGFzc2VzLmxlbmd0aDsgaiA8IGxlbjE7IGorKykge1xuXHRcdFx0XHRjID0gY2xhc3Nlc1tqXTtcblx0XHRcdFx0Y2xhc3Nfc2VsZWN0b3IgPSBjbGFzc19zZWxlY3RvciArICcuJyArIGM7XG5cdFx0XHR9XG5cdFx0XHRjaGVja2VkX3Jvd3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNsYXNzX3NlbGVjdG9yICsgJyAnICsgJ2lucHV0W2RhdGEtY2hlY2tdOmNoZWNrZWQnKTtcblx0XHRcdGlmIChjaGVja2VkX3Jvd3MubGVuZ3RoID09PSAxICYmIGNoZWNrZWRfcm93c1swXS5nZXRBdHRyaWJ1dGUoJ25hbWUnKSA9PT0gJ3RvZ2dsZS1hbGwnKSB7XG5cdFx0XHRcdGlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihjbGFzc19zZWxlY3RvciArICcgaW5wdXRbbmFtZT10b2dnbGUtYWxsXScpO1xuXHRcdFx0XHRpZiAoaW5wdXQpIHtcblx0XHRcdFx0XHRpbnB1dC5jaGVja2VkID0gZmFsc2U7XG5cdFx0XHRcdFx0aWUgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKFwiTVNJRSBcIik7XG5cdFx0XHRcdFx0aWYgKGllKSB7XG5cdFx0XHRcdFx0XHRldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xuXHRcdFx0XHRcdFx0ZXZlbnQuaW5pdEV2ZW50KCdjaGFuZ2UnLCB0cnVlLCB0cnVlKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZXZlbnQgPSBuZXcgRXZlbnQoJ2NoYW5nZScsIHtcblx0XHRcdFx0XHRcdFx0J2J1YmJsZXMnOiB0cnVlXG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0cmVzdWx0cy5wdXNoKGlucHV0LmRpc3BhdGNoRXZlbnQoZXZlbnQpKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXN1bHRzLnB1c2godm9pZCAwKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVzdWx0cy5wdXNoKHZvaWQgMCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXN1bHRzO1xuXHR9XG59KTtcblxuZGF0YUdyaWRSZWdpc3RlckV4dGVuc2lvbignZGF0YWdyaWQuc29ydGFibGUnLCB7XG5cdHN1Y2Nlc3M6IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiBkYXRhZ3JpZFNvcnRhYmxlKCk7XG5cdH1cbn0pO1xuXG5kYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCdkYXRhZ3JpZC5mb3JtcycsIHtcblx0c3VjY2VzczogZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuICQoJy5kYXRhZ3JpZCcpLmZpbmQoJ2Zvcm0nKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHdpbmRvdy5OZXR0ZS5pbml0Rm9ybSh0aGlzKTtcblx0XHR9KTtcblx0fVxufSk7XG5cbmRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24oJ2RhdGFncmlkLnVybCcsIHtcblx0c3VjY2VzczogZnVuY3Rpb24ocGF5bG9hZCkge1xuXHRcdHZhciBob3N0LCBwYXRoLCBxdWVyeSwgdXJsO1xuXHRcdGlmIChwYXlsb2FkLl9kYXRhZ3JpZF91cmwpIHtcblx0XHRcdGlmICh3aW5kb3cuaGlzdG9yeS5yZXBsYWNlU3RhdGUpIHtcblx0XHRcdFx0aG9zdCA9IHdpbmRvdy5sb2NhdGlvbi5wcm90b2NvbCArIFwiLy9cIiArIHdpbmRvdy5sb2NhdGlvbi5ob3N0O1xuXHRcdFx0XHRwYXRoID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lO1xuXHRcdFx0XHRxdWVyeSA9IHdpbmRvdy5kYXRhZ3JpZFNlcmlhbGl6ZVVybChwYXlsb2FkLnN0YXRlKS5yZXBsYWNlKC8mKyQvZ20sICcnKTtcblx0XHRcdFx0aWYgKHF1ZXJ5KSB7XG5cdFx0XHRcdFx0dXJsID0gaG9zdCArIHBhdGggKyBcIj9cIiArIHF1ZXJ5LnJlcGxhY2UoL1xcJiokLywgJycpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHVybCA9IGhvc3QgKyBwYXRoO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHVybCArPSB3aW5kb3cubG9jYXRpb24uaGFzaDtcblx0XHRcdFx0aWYgKHdpbmRvdy5sb2NhdGlvbi5ocmVmICE9PSB1cmwpIHtcblx0XHRcdFx0XHRyZXR1cm4gd2luZG93Lmhpc3RvcnkucmVwbGFjZVN0YXRlKHtcblx0XHRcdFx0XHRcdHBhdGg6IHVybFxuXHRcdFx0XHRcdH0sICcnLCB1cmwpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59KTtcblxuZGF0YUdyaWRSZWdpc3RlckV4dGVuc2lvbignZGF0YWdyaWQuc29ydCcsIHtcblx0c3VjY2VzczogZnVuY3Rpb24ocGF5bG9hZCkge1xuXHRcdHZhciBocmVmLCBrZXksIHJlZiwgcmVzdWx0cztcblx0XHRpZiAocGF5bG9hZC5fZGF0YWdyaWRfc29ydCkge1xuXHRcdFx0cmVmID0gcGF5bG9hZC5fZGF0YWdyaWRfc29ydDtcblx0XHRcdHJlc3VsdHMgPSBbXTtcblx0XHRcdGZvciAoa2V5IGluIHJlZikge1xuXHRcdFx0XHRocmVmID0gcmVmW2tleV07XG5cdFx0XHRcdHJlc3VsdHMucHVzaCgkKCcjZGF0YWdyaWQtc29ydC0nICsga2V5KS5hdHRyKCdocmVmJywgaHJlZikpO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHJlc3VsdHM7XG5cdFx0fVxuXHR9XG59KTtcblxuZGF0YUdyaWRSZWdpc3RlckV4dGVuc2lvbignZGF0YXJnaWQuaXRlbV9kZXRhaWwnLCB7XG5cdGJlZm9yZTogZnVuY3Rpb24oeGhyLCBzZXR0aW5ncykge1xuXHRcdHZhciBpZCwgcm93X2RldGFpbCwgZ3JpZF9mdWxsbmFtZTtcblx0XHRpZiAoc2V0dGluZ3MubmV0dGUgJiYgc2V0dGluZ3MubmV0dGUuZWwuYXR0cignZGF0YS10b2dnbGUtZGV0YWlsJykpIHtcblx0XHRcdGlkID0gc2V0dGluZ3MubmV0dGUuZWwuYXR0cignZGF0YS10b2dnbGUtZGV0YWlsJyk7XG5cdFx0XHRncmlkX2Z1bGxuYW1lID0gc2V0dGluZ3MubmV0dGUuZWwuYXR0cignZGF0YS10b2dnbGUtZGV0YWlsLWdyaWQtZnVsbG5hbWUnKTtcblx0XHRcdHJvd19kZXRhaWwgPSAkKCcuaXRlbS1kZXRhaWwtJyArIGdyaWRfZnVsbG5hbWUgKyAnLWlkLScgKyBpZCk7XG5cdFx0XHRpZiAocm93X2RldGFpbC5oYXNDbGFzcygnbG9hZGVkJykpIHtcblx0XHRcdFx0aWYgKCFyb3dfZGV0YWlsLmZpbmQoJy5pdGVtLWRldGFpbC1jb250ZW50JykubGVuZ3RoKSB7XG5cdFx0XHRcdFx0cm93X2RldGFpbC5yZW1vdmVDbGFzcygndG9nZ2xlZCcpO1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChyb3dfZGV0YWlsLmhhc0NsYXNzKCd0b2dnbGVkJykpIHtcblx0XHRcdFx0XHRyb3dfZGV0YWlsLmZpbmQoJy5pdGVtLWRldGFpbC1jb250ZW50Jykuc2xpZGVUb2dnbGUoJ2Zhc3QnLCAoZnVuY3Rpb24oX3RoaXMpIHtcblx0XHRcdFx0XHRcdHJldHVybiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHJvd19kZXRhaWwudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fSkodGhpcykpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJvd19kZXRhaWwudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcblx0XHRcdFx0XHRyb3dfZGV0YWlsLmZpbmQoJy5pdGVtLWRldGFpbC1jb250ZW50Jykuc2xpZGVUb2dnbGUoJ2Zhc3QnKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gcm93X2RldGFpbC5hZGRDbGFzcygnbG9hZGVkJyk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXHRzdWNjZXNzOiBmdW5jdGlvbihwYXlsb2FkKSB7XG5cdFx0dmFyIGlkLCByb3dfZGV0YWlsLCBncmlkX2Z1bGxuYW1lO1xuXHRcdGlmIChwYXlsb2FkLl9kYXRhZ3JpZF90b2dnbGVfZGV0YWlsICYmIHBheWxvYWQuX2RhdGFncmlkX25hbWUpIHtcblx0XHRcdGlkID0gcGF5bG9hZC5fZGF0YWdyaWRfdG9nZ2xlX2RldGFpbDtcblx0XHRcdGdyaWRfZnVsbG5hbWUgPSBwYXlsb2FkLl9kYXRhZ3JpZF9uYW1lO1xuXHRcdFx0cm93X2RldGFpbCA9ICQoJy5pdGVtLWRldGFpbC0nICsgZ3JpZF9mdWxsbmFtZSArICctaWQtJyArIGlkKTtcblx0XHRcdHJvd19kZXRhaWwudG9nZ2xlQ2xhc3MoJ3RvZ2dsZWQnKTtcblx0XHRcdHJldHVybiByb3dfZGV0YWlsLmZpbmQoJy5pdGVtLWRldGFpbC1jb250ZW50Jykuc2xpZGVUb2dnbGUoJ2Zhc3QnKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5kYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCdkYXRhZ3JpZC50cmVlJywge1xuXHRiZWZvcmU6IGZ1bmN0aW9uKHhociwgc2V0dGluZ3MpIHtcblx0XHR2YXIgY2hpbGRyZW5fYmxvY2s7XG5cdFx0aWYgKHNldHRpbmdzLm5ldHRlICYmIHNldHRpbmdzLm5ldHRlLmVsLmF0dHIoJ2RhdGEtdG9nZ2xlLXRyZWUnKSkge1xuXHRcdFx0c2V0dGluZ3MubmV0dGUuZWwudG9nZ2xlQ2xhc3MoJ3RvZ2dsZS1yb3RhdGUnKTtcblx0XHRcdGNoaWxkcmVuX2Jsb2NrID0gc2V0dGluZ3MubmV0dGUuZWwuY2xvc2VzdCgnLmRhdGFncmlkLXRyZWUtaXRlbScpLmZpbmQoJy5kYXRhZ3JpZC10cmVlLWl0ZW0tY2hpbGRyZW4nKS5maXJzdCgpO1xuXHRcdFx0aWYgKGNoaWxkcmVuX2Jsb2NrLmhhc0NsYXNzKCdsb2FkZWQnKSkge1xuXHRcdFx0XHRjaGlsZHJlbl9ibG9jay5zbGlkZVRvZ2dsZSgnZmFzdCcpO1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB0cnVlO1xuXHR9LFxuXHRzdWNjZXNzOiBmdW5jdGlvbihwYXlsb2FkKSB7XG5cdFx0dmFyIGNoaWxkcmVuX2Jsb2NrLCBjb250ZW50LCBpZCwgbmFtZSwgcmVmLCBzbmlwcGV0LCB0ZW1wbGF0ZTtcblx0XHRpZiAocGF5bG9hZC5fZGF0YWdyaWRfdHJlZSkge1xuXHRcdFx0aWQgPSBwYXlsb2FkLl9kYXRhZ3JpZF90cmVlO1xuXHRcdFx0Y2hpbGRyZW5fYmxvY2sgPSAkKCcuZGF0YWdyaWQtdHJlZS1pdGVtW2RhdGEtaWQ9XCInICsgaWQgKyAnXCJdJykuZmluZCgnLmRhdGFncmlkLXRyZWUtaXRlbS1jaGlsZHJlbicpLmZpcnN0KCk7XG5cdFx0XHRjaGlsZHJlbl9ibG9jay5hZGRDbGFzcygnbG9hZGVkJyk7XG5cdFx0XHRyZWYgPSBwYXlsb2FkLnNuaXBwZXRzO1xuXHRcdFx0Zm9yIChuYW1lIGluIHJlZikge1xuXHRcdFx0XHRzbmlwcGV0ID0gcmVmW25hbWVdO1xuXHRcdFx0XHRjb250ZW50ID0gJChzbmlwcGV0KTtcblx0XHRcdFx0dGVtcGxhdGUgPSAkKCc8ZGl2IGNsYXNzPVwiZGF0YWdyaWQtdHJlZS1pdGVtXCIgaWQ9XCInICsgbmFtZSArICdcIj4nKTtcblx0XHRcdFx0dGVtcGxhdGUuYXR0cignZGF0YS1pZCcsIGNvbnRlbnQuYXR0cignZGF0YS1pZCcpKTtcblx0XHRcdFx0dGVtcGxhdGUuYXBwZW5kKGNvbnRlbnQpO1xuXHRcdFx0XHRpZiAoY29udGVudC5kYXRhKCdoYXMtY2hpbGRyZW4nKSkge1xuXHRcdFx0XHRcdHRlbXBsYXRlLmFkZENsYXNzKCdoYXMtY2hpbGRyZW4nKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjaGlsZHJlbl9ibG9jay5hcHBlbmQodGVtcGxhdGUpO1xuXHRcdFx0fVxuXHRcdFx0Y2hpbGRyZW5fYmxvY2suYWRkQ2xhc3MoJ2xvYWRlZCcpO1xuXHRcdFx0Y2hpbGRyZW5fYmxvY2suc2xpZGVUb2dnbGUoJ2Zhc3QnKTtcblx0XHRcdGRhdGFHcmlkTG9hZCgpO1xuXHRcdH1cblx0XHRyZXR1cm4gZGF0YWdyaWRTb3J0YWJsZVRyZWUoKTtcblx0fVxufSk7XG5cbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1kYXRhZ3JpZC1lZGl0YWJsZS11cmxdJywgZnVuY3Rpb24oZXZlbnQpIHtcblx0dmFyIGF0dHJfbmFtZSwgYXR0cl92YWx1ZSwgYXR0cnMsIGNlbGwsIGNlbGxWYWx1ZSwgY2VsbF9oZWlnaHQsIGNlbGxfbGluZXMsIGNlbGxfcGFkZGluZywgaW5wdXQsIGxpbmVfaGVpZ2h0LCBzdWJtaXQsIHZhbHVlVG9FZGl0O1xuXHRjZWxsID0gJCh0aGlzKTtcblx0aWYgKGV2ZW50LnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdhJykge1xuXHRcdHJldHVybjtcblx0fVxuXHRpZiAoY2VsbC5oYXNDbGFzcygnZGF0YWdyaWQtaW5saW5lLWVkaXQnKSkge1xuXHRcdHJldHVybjtcblx0fVxuXHRpZiAoIWNlbGwuaGFzQ2xhc3MoJ2VkaXRpbmcnKSkge1xuXHRcdGNlbGwuYWRkQ2xhc3MoJ2VkaXRpbmcnKTtcblx0XHRjZWxsVmFsdWUgPSBjZWxsLmh0bWwoKS50cmltKCkucmVwbGFjZSgnPGJyPicsICdcXG4nKTtcblx0XHRpZiAoY2VsbC5hdHRyKCdkYXRhLWRhdGFncmlkLWVkaXRhYmxlLXZhbHVlJykpIHtcblx0XHRcdHZhbHVlVG9FZGl0ID0gY2VsbC5kYXRhKCdkYXRhZ3JpZC1lZGl0YWJsZS12YWx1ZScpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YWx1ZVRvRWRpdCA9IGNlbGxWYWx1ZTtcblx0XHR9XG5cdFx0Y2VsbC5kYXRhKCdvcmlnaW5hbFZhbHVlJywgY2VsbFZhbHVlKTtcblx0XHRjZWxsLmRhdGEoJ3ZhbHVlVG9FZGl0JywgdmFsdWVUb0VkaXQpO1xuXHRcdGlmIChjZWxsLmRhdGEoJ2RhdGFncmlkLWVkaXRhYmxlLXR5cGUnKSA9PT0gJ3RleHRhcmVhJykge1xuXHRcdFx0aW5wdXQgPSAkKCc8dGV4dGFyZWE+JyArIHZhbHVlVG9FZGl0ICsgJzwvdGV4dGFyZWE+Jyk7XG5cdFx0XHRjZWxsX3BhZGRpbmcgPSBwYXJzZUludChjZWxsLmNzcygncGFkZGluZycpLnJlcGxhY2UoL1teLVxcZFxcLl0vZywgJycpLCAxMCk7XG5cdFx0XHRjZWxsX2hlaWdodCA9IGNlbGwub3V0ZXJIZWlnaHQoKTtcblx0XHRcdGxpbmVfaGVpZ2h0ID0gTWF0aC5yb3VuZChwYXJzZUZsb2F0KGNlbGwuY3NzKCdsaW5lLWhlaWdodCcpKSk7XG5cdFx0XHRjZWxsX2xpbmVzID0gKGNlbGxfaGVpZ2h0IC0gKDIgKiBjZWxsX3BhZGRpbmcpKSAvIGxpbmVfaGVpZ2h0O1xuXHRcdFx0aW5wdXQuYXR0cigncm93cycsIE1hdGgucm91bmQoY2VsbF9saW5lcykpO1xuXHRcdH0gZWxzZSBpZiAoY2VsbC5kYXRhKCdkYXRhZ3JpZC1lZGl0YWJsZS10eXBlJykgPT09ICdzZWxlY3QnKSB7XG5cdFx0XHRpbnB1dCA9ICQoY2VsbC5kYXRhKCdkYXRhZ3JpZC1lZGl0YWJsZS1lbGVtZW50JykpO1xuXHRcdFx0aW5wdXQuZmluZChcIm9wdGlvblt2YWx1ZT0nXCIgKyB2YWx1ZVRvRWRpdCArIFwiJ11cIikucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aW5wdXQgPSAkKCc8aW5wdXQgdHlwZT1cIicgKyBjZWxsLmRhdGEoJ2RhdGFncmlkLWVkaXRhYmxlLXR5cGUnKSArICdcIj4nKTtcblx0XHRcdGlucHV0LnZhbCh2YWx1ZVRvRWRpdCk7XG5cdFx0fVxuXHRcdGF0dHJzID0gY2VsbC5kYXRhKCdkYXRhZ3JpZC1lZGl0YWJsZS1hdHRycycpO1xuXHRcdGZvciAoYXR0cl9uYW1lIGluIGF0dHJzKSB7XG5cdFx0XHRhdHRyX3ZhbHVlID0gYXR0cnNbYXR0cl9uYW1lXTtcblx0XHRcdGlucHV0LmF0dHIoYXR0cl9uYW1lLCBhdHRyX3ZhbHVlKTtcblx0XHR9XG5cdFx0Y2VsbC5yZW1vdmVDbGFzcygnZWRpdGVkJyk7XG5cdFx0Y2VsbC5odG1sKGlucHV0KTtcblx0XHRzdWJtaXQgPSBmdW5jdGlvbihjZWxsLCBlbCkge1xuXHRcdFx0dmFyIHZhbHVlO1xuXHRcdFx0dmFsdWUgPSBlbC52YWwoKTtcblx0XHRcdGlmICh2YWx1ZSAhPT0gY2VsbC5kYXRhKCd2YWx1ZVRvRWRpdCcpKSB7XG5cdFx0XHRcdGRhdGFHcmlkUmVnaXN0ZXJBamF4Q2FsbCh7XG5cdFx0XHRcdFx0dXJsOiBjZWxsLmRhdGEoJ2RhdGFncmlkLWVkaXRhYmxlLXVybCcpLFxuXHRcdFx0XHRcdGRhdGE6IHtcblx0XHRcdFx0XHRcdHZhbHVlOiB2YWx1ZVxuXHRcdFx0XHRcdH0sXG5cdFx0XHRcdFx0dHlwZTogJ1BPU1QnLFxuXHRcdFx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKHBheWxvYWQpIHtcblx0XHRcdFx0XHRcdGlmIChjZWxsLmRhdGEoJ2RhdGFncmlkLWVkaXRhYmxlLXR5cGUnKSA9PT0gJ3NlbGVjdCcpIHtcblx0XHRcdFx0XHRcdFx0Y2VsbC5odG1sKGlucHV0LmZpbmQoXCJvcHRpb25bdmFsdWU9J1wiICsgdmFsdWUgKyBcIiddXCIpLmh0bWwoKSk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZiAocGF5bG9hZC5fZGF0YWdyaWRfZWRpdGFibGVfbmV3X3ZhbHVlKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFsdWUgPSBwYXlsb2FkLl9kYXRhZ3JpZF9lZGl0YWJsZV9uZXdfdmFsdWU7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0Y2VsbC5odG1sKHZhbHVlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdHJldHVybiBjZWxsLmFkZENsYXNzKCdlZGl0ZWQnKTtcblx0XHRcdFx0XHR9LFxuXHRcdFx0XHRcdGVycm9yOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdGNlbGwuaHRtbChjZWxsLmRhdGEoJ29yaWdpbmFsVmFsdWUnKSk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gY2VsbC5hZGRDbGFzcygnZWRpdGVkLWVycm9yJyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNlbGwuaHRtbChjZWxsLmRhdGEoJ29yaWdpbmFsVmFsdWUnKSk7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGNlbGwucmVtb3ZlQ2xhc3MoJ2VkaXRpbmcnKTtcblx0XHRcdH0sIDEyMDApO1xuXHRcdH07XG5cdFx0Y2VsbC5maW5kKCdpbnB1dCx0ZXh0YXJlYSxzZWxlY3QnKS5mb2N1cygpLm9uKCdibHVyJywgZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gc3VibWl0KGNlbGwsICQodGhpcykpO1xuXHRcdH0pLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZSkge1xuXHRcdFx0aWYgKGNlbGwuZGF0YSgnZGF0YWdyaWQtZWRpdGFibGUtdHlwZScpICE9PSAndGV4dGFyZWEnKSB7XG5cdFx0XHRcdGlmIChlLndoaWNoID09PSAxMykge1xuXHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdHJldHVybiBzdWJtaXQoY2VsbCwgJCh0aGlzKSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmIChlLndoaWNoID09PSAyNykge1xuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdGNlbGwucmVtb3ZlQ2xhc3MoJ2VkaXRpbmcnKTtcblx0XHRcdFx0cmV0dXJuIGNlbGwuaHRtbChjZWxsLmRhdGEoJ29yaWdpbmFsVmFsdWUnKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGNlbGwuZmluZCgnc2VsZWN0Jykub24oJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHN1Ym1pdChjZWxsLCAkKHRoaXMpKTtcblx0XHR9KTtcblx0fVxufSk7XG5cbmRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24oJ2RhdGFncmlkLmFmdGVyX2lubGluZV9lZGl0Jywge1xuXHRzdWNjZXNzOiBmdW5jdGlvbihwYXlsb2FkKSB7XG5cdFx0dmFyIGdyaWQgPSAkKCcuZGF0YWdyaWQtJyArIHBheWxvYWQuX2RhdGFncmlkX25hbWUpO1xuXG5cdFx0aWYgKHBheWxvYWQuX2RhdGFncmlkX2lubGluZV9lZGl0ZWQpIHtcblx0XHRcdGdyaWQuZmluZCgndHJbZGF0YS1pZD0nICsgcGF5bG9hZC5fZGF0YWdyaWRfaW5saW5lX2VkaXRlZCArICddID4gdGQnKS5hZGRDbGFzcygnZWRpdGVkJyk7XG5cdFx0XHRyZXR1cm4gZ3JpZC5maW5kKCcuZGF0YWdyaWQtaW5saW5lLWVkaXQtdHJpZ2dlcicpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblx0XHR9IGVsc2UgaWYgKHBheWxvYWQuX2RhdGFncmlkX2lubGluZV9lZGl0X2NhbmNlbCkge1xuXHRcdFx0cmV0dXJuIGdyaWQuZmluZCgnLmRhdGFncmlkLWlubGluZS1lZGl0LXRyaWdnZXInKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cdFx0fVxuXHR9XG59KTtcblxuJChkb2N1bWVudCkub24oJ21vdXNldXAnLCAnW2RhdGEtZGF0YWdyaWQtY2FuY2VsLWlubGluZS1hZGRdJywgZnVuY3Rpb24oZSkge1xuXHR2YXIgY29kZSA9IGUud2hpY2ggfHwgZS5rZXlDb2RlIHx8IDA7XG5cdGlmIChjb2RlID09PSAxKSB7XG5cdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0cmV0dXJuICQoJy5kYXRhZ3JpZC1yb3ctaW5saW5lLWFkZCcpLmFkZENsYXNzKCdkYXRhZ3JpZC1yb3ctaW5saW5lLWFkZC1oaWRkZW4nKTtcblx0fVxufSk7XG5cbmRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24oJ2RhdGFncmlkLXRvZ2dsZS1pbmxpbmUtYWRkJywge1xuXHRzdWNjZXNzOiBmdW5jdGlvbihwYXlsb2FkKSB7XG5cdFx0dmFyIGdyaWQgPSAkKCcuZGF0YWdyaWQtJyArIHBheWxvYWQuX2RhdGFncmlkX25hbWUpO1xuXG5cdFx0aWYgKHBheWxvYWQuX2RhdGFncmlkX2lubGluZV9hZGRpbmcpIHtcblx0XHRcdHZhciByb3cgPSBncmlkLmZpbmQoJy5kYXRhZ3JpZC1yb3ctaW5saW5lLWFkZCcpO1xuXG5cdFx0XHRpZiAocm93Lmhhc0NsYXNzKCdkYXRhZ3JpZC1yb3ctaW5saW5lLWFkZC1oaWRkZW4nKSkge1xuXHRcdFx0XHRyb3cucmVtb3ZlQ2xhc3MoJ2RhdGFncmlkLXJvdy1pbmxpbmUtYWRkLWhpZGRlbicpO1xuXHRcdFx0fVxuXG5cdFx0XHRyb3cuZmluZCgnaW5wdXQ6bm90KFtyZWFkb25seV0pLHRleHRhcmVhOm5vdChbcmVhZG9ubHldKScpLmZpcnN0KCkuZm9jdXMoKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5kYXRhZ3JpZEZpdGxlck11bHRpU2VsZWN0ID0gZnVuY3Rpb24oKSB7XG5cdHZhciBzZWxlY3QgPSAkKCcuc2VsZWN0cGlja2VyJykuZmlyc3QoKTtcblxuXHRpZiAoJC5mbi5zZWxlY3RwaWNrZXIpIHtcblx0XHRyZXR1cm4gJC5mbi5zZWxlY3RwaWNrZXIuZGVmYXVsdHMgPSB7XG5cdFx0XHRjb3VudFNlbGVjdGVkVGV4dDogc2VsZWN0LmRhdGEoJ2kxOG4tc2VsZWN0ZWQnKSxcblx0XHRcdGljb25CYXNlOiAnJyxcblx0XHRcdHRpY2tJY29uOiBzZWxlY3QuZGF0YSgnc2VsZWN0ZWQtaWNvbi1jaGVjaycpXG5cdFx0fTtcblx0fVxufTtcblxuJChmdW5jdGlvbigpIHtcblx0cmV0dXJuIGRhdGFncmlkRml0bGVyTXVsdGlTZWxlY3QoKTtcbn0pO1xuXG5kYXRhZ3JpZEdyb3VwQWN0aW9uTXVsdGlTZWxlY3QgPSBmdW5jdGlvbigpIHtcblx0dmFyIHNlbGVjdHM7XG5cblx0aWYgKCEkLmZuLnNlbGVjdHBpY2tlcikge1xuXHRcdHJldHVybjtcblx0fVxuXG5cdHNlbGVjdHMgPSAkKCdbZGF0YS1kYXRhZ3JpZC1tdWx0aXNlbGVjdC1pZF0nKTtcblxuXHRyZXR1cm4gc2VsZWN0cy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdHZhciBpZDtcblx0XHRpZiAoJCh0aGlzKS5oYXNDbGFzcygnc2VsZWN0cGlja2VyJykpIHtcblx0XHRcdCQodGhpcykucmVtb3ZlQXR0cignaWQnKTtcblx0XHRcdGlkID0gJCh0aGlzKS5kYXRhKCdkYXRhZ3JpZC1tdWx0aXNlbGVjdC1pZCcpO1xuXHRcdFx0JCh0aGlzKS5vbignbG9hZGVkLmJzLnNlbGVjdCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0JCh0aGlzKS5wYXJlbnQoKS5hdHRyKCdzdHlsZScsICdkaXNwbGF5Om5vbmU7Jyk7XG5cdFx0XHRcdHJldHVybiAkKHRoaXMpLnBhcmVudCgpLmZpbmQoJy5oaWRkZW4nKS5yZW1vdmVDbGFzcygnaGlkZGVuJykuYWRkQ2xhc3MoJ2J0bi1kZWZhdWx0IGJ0bi1zZWNvbmRhcnknKTtcblx0XHRcdH0pO1xuXHRcdFx0cmV0dXJuICQodGhpcykub24oJ3JlbmRlcmVkLmJzLnNlbGVjdCcsIGZ1bmN0aW9uKGUpIHtcblx0XHRcdFx0cmV0dXJuICQodGhpcykucGFyZW50KCkuYXR0cignaWQnLCBpZCk7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH0pO1xufTtcblxuJChmdW5jdGlvbigpIHtcblx0cmV0dXJuIGRhdGFncmlkR3JvdXBBY3Rpb25NdWx0aVNlbGVjdCgpO1xufSk7XG5cbmRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24oJ2RhdGFncmlkLmZpdGxlck11bHRpU2VsZWN0Jywge1xuXHRzdWNjZXNzOiBmdW5jdGlvbigpIHtcblx0XHRkYXRhZ3JpZEZpdGxlck11bHRpU2VsZWN0KCk7XG5cdFx0aWYgKCQuZm4uc2VsZWN0cGlja2VyKSB7XG5cdFx0XHRyZXR1cm4gJCgnLnNlbGVjdHBpY2tlcicpLnNlbGVjdHBpY2tlcih7XG5cdFx0XHRcdGljb25CYXNlOiAnZmEnXG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cbn0pO1xuXG5kYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCdkYXRhZ3JpZC5ncm91cEFjdGlvbk11bHRpU2VsZWN0Jywge1xuXHRzdWNjZXNzOiBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gZGF0YWdyaWRHcm91cEFjdGlvbk11bHRpU2VsZWN0KCk7XG5cdH1cbn0pO1xuXG5kYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCdkYXRhZ3JpZC5pbmxpbmUtZWRpdGluZycsIHtcblx0c3VjY2VzczogZnVuY3Rpb24ocGF5bG9hZCkge1xuXHRcdHZhciBncmlkO1xuXHRcdGlmIChwYXlsb2FkLl9kYXRhZ3JpZF9pbmxpbmVfZWRpdGluZykge1xuXHRcdFx0Z3JpZCA9ICQoJy5kYXRhZ3JpZC0nICsgcGF5bG9hZC5fZGF0YWdyaWRfbmFtZSk7XG5cdFx0XHRyZXR1cm4gZ3JpZC5maW5kKCcuZGF0YWdyaWQtaW5saW5lLWVkaXQtdHJpZ2dlcicpLmFkZENsYXNzKCdoaWRkZW4nKTtcblx0XHR9XG5cdH1cbn0pO1xuXG5kYXRhR3JpZFJlZ2lzdGVyRXh0ZW5zaW9uKCdkYXRhZ3JpZC5yZWRyYXctaXRlbScsIHtcblx0c3VjY2VzczogZnVuY3Rpb24ocGF5bG9hZCkge1xuXHRcdHZhciByb3c7XG5cdFx0aWYgKHBheWxvYWQuX2RhdGFncmlkX3JlZHJhd19pdGVtX2NsYXNzKSB7XG5cdFx0XHRyb3cgPSAkKCd0cltkYXRhLWlkPScgKyBwYXlsb2FkLl9kYXRhZ3JpZF9yZWRyYXdfaXRlbV9pZCArICddJyk7XG5cdFx0XHRyZXR1cm4gcm93LmF0dHIoJ2NsYXNzJywgcGF5bG9hZC5fZGF0YWdyaWRfcmVkcmF3X2l0ZW1fY2xhc3MpO1xuXHRcdH1cblx0fVxufSk7XG5cbmRhdGFHcmlkUmVnaXN0ZXJFeHRlbnNpb24oJ2RhdGFncmlkLnJlc2V0LWZpbHRlci1ieS1jb2x1bW4nLCB7XG5cdHN1Y2Nlc3M6IGZ1bmN0aW9uKHBheWxvYWQpIHtcblx0XHR2YXIgZ3JpZCwgaHJlZiwgaSwga2V5LCBsZW4sIHJlZjtcblx0XHRpZiAoIXBheWxvYWQuX2RhdGFncmlkX25hbWUpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0Z3JpZCA9ICQoJy5kYXRhZ3JpZC0nICsgcGF5bG9hZC5fZGF0YWdyaWRfbmFtZSk7XG5cdFx0Z3JpZC5maW5kKCdbZGF0YS1kYXRhZ3JpZC1yZXNldC1maWx0ZXItYnktY29sdW1uXScpLmFkZENsYXNzKCdoaWRkZW4nKTtcblx0XHRpZiAocGF5bG9hZC5ub25fZW1wdHlfZmlsdGVycyAmJiBwYXlsb2FkLm5vbl9lbXB0eV9maWx0ZXJzLmxlbmd0aCkge1xuXHRcdFx0cmVmID0gcGF5bG9hZC5ub25fZW1wdHlfZmlsdGVycztcblx0XHRcdGZvciAoaSA9IDAsIGxlbiA9IHJlZi5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHRcdFx0XHRrZXkgPSByZWZbaV07XG5cdFx0XHRcdGdyaWQuZmluZCgnW2RhdGEtZGF0YWdyaWQtcmVzZXQtZmlsdGVyLWJ5LWNvbHVtbj0nICsga2V5ICsgJ10nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG5cdFx0XHR9XG5cdFx0XHRocmVmID0gZ3JpZC5maW5kKCcucmVzZXQtZmlsdGVyJykuYXR0cignaHJlZicpO1xuXHRcdFx0cmV0dXJuIGdyaWQuZmluZCgnW2RhdGEtZGF0YWdyaWQtcmVzZXQtZmlsdGVyLWJ5LWNvbHVtbl0nKS5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHR2YXIgbmV3X2hyZWY7XG5cdFx0XHRcdGtleSA9ICQodGhpcykuYXR0cignZGF0YS1kYXRhZ3JpZC1yZXNldC1maWx0ZXItYnktY29sdW1uJyk7XG5cdFx0XHRcdG5ld19ocmVmID0gaHJlZi5yZXBsYWNlKCdkbz0nICsgcGF5bG9hZC5fZGF0YWdyaWRfbmFtZSArICctcmVzZXRGaWx0ZXInLCAnZG89JyArIHBheWxvYWQuX2RhdGFncmlkX25hbWUgKyAnLXJlc2V0Q29sdW1uRmlsdGVyJyk7XG5cdFx0XHRcdG5ld19ocmVmICs9ICcmJyArIHBheWxvYWQuX2RhdGFncmlkX25hbWUgKyAnLWtleT0nICsga2V5O1xuXHRcdFx0XHRyZXR1cm4gJCh0aGlzKS5hdHRyKCdocmVmJywgbmV3X2hyZWYpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHR9XG59KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==